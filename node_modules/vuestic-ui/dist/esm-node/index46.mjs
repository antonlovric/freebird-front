import{w as e}from"./withConfigTransport.mjs";import{defineComponent as o,shallowRef as t,ref as r,computed as n,watch as l,resolveComponent as a,openBlock as s,createElementBlock as p,withKeys as i,withModifiers as u,Fragment as c,renderList as d,toDisplayString as v,createCommentVNode as m,normalizeClass as f,normalizeStyle as g,createBlock as y,createElementVNode as h,withDirectives as b,createVNode as O,vShow as S,nextTick as w,withCtx as x,createSlots as C,mergeProps as I,renderSlot as k,normalizeProps as j,createTextVNode as B}from"vue";import{w as T}from"./utils.mjs";import"./global-config.mjs";import"./usePopover.mjs";import"./global-utils.mjs";import{u as V,b as _,c as A,a as $}from"./VaInput.mjs";import{b as H,u as P}from"./useColors.mjs";import{u as N}from"./useForm.mjs";import{u as F}from"./useLoading.mjs";import{a as D,u as E,b as L}from"./index67.mjs";import{u as K,a as M}from"./useSelectableList.mjs";import{VaDropdown as q,VaDropdownContent as G}from"./index27.mjs";import{VaIcon as U}from"./index31.mjs";import{VaInput as W}from"./index35.mjs";import{s as z}from"./VaInputWrapper.mjs";import"./VaConfig.mjs";import"./global-properties.mjs";import"./isSymbol.mjs";import"./ssr-utils.mjs";import"./VaIcon.mjs";import"./useSize.mjs";import"./child-props.mjs";import"./useFocus.mjs";import"colortranslator";import"./useEmitProxy.mjs";import"./useCaptureEvent.mjs";import"cleave.js";import"./useBem.mjs";import"./_createCompounder.mjs";import"./useSyncProp.mjs";import"./consts.mjs";import"./debounce.mjs";import"./toNumber.mjs";import"./useStateful.mjs";import"./useTextColor.mjs";import"./VaMessageListWrapper.mjs";import"./useCSSVariables.mjs";const R={maxSelections:{type:[Number,String],default:void 0}};var J=o({name:"VaSelectOptionList",components:{VaIcon:U},emits:["select-option","update:hoveredOption","no-previous-option-to-hover","scroll-bottom"],props:{...H,options:{type:Array,default:()=>[]},noOptionsText:{type:String,default:"Items not found"},getSelectedState:{type:Function,required:!0},getText:{type:Function,required:!0},getTrackBy:{type:Function,required:!0},getGroupBy:{type:Function,required:!0},multiple:{type:Boolean,default:!1},search:{type:String,default:""},tabindex:{type:Number,default:0},hoveredOption:{type:[String,Number,Object],default:null}},setup(e,{emit:o}){const{getColor:a,getHoverColor:s}=P(),p=t(),i=r({}),u=n({get:()=>e.hoveredOption||null,set:e=>o("update:hoveredOption",e)}),c=n((()=>e.search?e.options.filter((o=>{const t=e.getText(o).toString().toUpperCase(),r=e.search.toUpperCase();return t.includes(r)})):e.options)),d=n((()=>c.value.reduce(((o,t)=>{if("object"==typeof t&&t.group){const r=e.getGroupBy(t);o[r]||(o[r]=[]),o[r].push(t)}else o._noGroup.push(t);return o}),{_noGroup:[]}))),isHovered=o=>!!u.value&&("string"==typeof o?o===u.value:!!e.getTrackBy&&e.getTrackBy(u.value)===e.getTrackBy(o)),updateHoveredOption=e=>{u.value=e||null},v=n((()=>c.value.findIndex((o=>!!u.value&&e.getTrackBy(o)===e.getTrackBy(u.value))))),scrollToOption=o=>{if(!o)return;const t=i.value[e.getTrackBy(o)];t&&((e,o={scrollTarget:e.parentElement,verticalAlignment:"any",smooth:!1})=>{const t=o.scrollTarget||e.parentElement,r=((e,o,t)=>{const r=o.offsetHeight,n=o.scrollTop,l=(e=>e.offsetTop)(e)-o.offsetTop,a=(e=>e.offsetTop+e.offsetHeight/2)(e)-o.offsetTop,s=(e=>e.offsetTop+e.offsetHeight)(e)-o.offsetTop;if("start"===t)return l;if("end"===t)return s-r;if("center"===t)return a-r/2;if("any"===t){if(l-n<0)return l;if(s-n>r)return s-r}})(e,t,o.verticalAlignment);void 0!==r&&t.scroll({top:r,behavior:o.smooth?"smooth":"auto"})})(t)};l((()=>e.hoveredOption),(e=>e&&scrollToOption(e)));const m={hoverPreviousOption:()=>{u.value?c.value[v.value-1]?u.value=c.value[v.value-1]:o("no-previous-option-to-hover"):c.value.length&&updateHoveredOption(c.value.at(-1))},hoverNextOption:()=>{u.value?c.value[v.value+1]&&(u.value=c.value[v.value+1]):c.value.length&&updateHoveredOption(c.value[0])},hoverFirstOption:()=>{c.value.length>0&&updateHoveredOption(c.value[0])},focus:()=>{var e;null===(e=p.value)||void 0===e||e.focus({preventScroll:!0})},scrollToOption:scrollToOption};return{rootElement:p,getColor:a,filteredOptions:c,optionGroups:d,onScroll:e=>{const t=e.target;t&&t.scrollTop+t.clientHeight===t.scrollHeight&&o("scroll-bottom")},beforeUpdate:()=>{i.value={}},setItemRef:o=>t=>{t&&(i.value[e.getTrackBy(o)]=t)},selectOption:e=>o("select-option",e),getOptionIcon:e=>"object"==typeof e?e.icon:void 0,getOptionClass:o=>({"va-select-option-list__option":!0,"va-select-option-list__option--selected":e.getSelectedState(o)}),getOptionStyle:o=>({color:e.getSelectedState(o)?a(e.color):"inherit",backgroundColor:isHovered(o)?s(a(e.color)):"transparent"}),updateHoveredOption:updateHoveredOption,...m}}});const Q=["tabindex"],X={key:0,class:"va-select-option-list__group-name"},Y=["aria-selected","onClick","onMouseover"],Z={key:0,class:"va-select-option-list no-options"};J.render=function render$1(e,o,t,r,n,l){const w=a("va-icon");return s(),p("div",{ref:"rootElement",class:"va-select-option-list",tabindex:e.tabindex,onKeydown:[o[0]||(o[0]=i(u(((...o)=>e.hoverPreviousOption&&e.hoverPreviousOption(...o)),["stop","prevent"]),["up"])),o[1]||(o[1]=i(u(((...o)=>e.hoverPreviousOption&&e.hoverPreviousOption(...o)),["stop","prevent"]),["left"])),o[2]||(o[2]=i(u(((...o)=>e.hoverNextOption&&e.hoverNextOption(...o)),["stop","prevent"]),["down"])),o[3]||(o[3]=i(u(((...o)=>e.hoverNextOption&&e.hoverNextOption(...o)),["stop","prevent"]),["right"]))],onScrollPassive:o[4]||(o[4]=(...o)=>e.onScroll&&e.onScroll(...o))},[(s(!0),p(c,null,d(e.optionGroups,((o,t)=>(s(),p(c,{key:t},["_noGroup"!==t?(s(),p("span",X,v(t),1)):m("v-if",!0),(s(!0),p(c,null,d(o,(o=>(s(),p("div",{key:e.$props.getTrackBy(o),ref_for:!0,ref:e.setItemRef(o),role:"option","aria-selected":!!e.$props.getSelectedState(o),class:f(e.getOptionClass(o)),style:g(e.getOptionStyle(o)),onClick:t=>e.selectOption(o),onMouseover:t=>e.updateHoveredOption(o)},[e.getOptionIcon(o)?(s(),y(w,{key:0,size:"small",class:"va-select-option-list__option--icon",name:e.getOptionIcon(o)},null,8,["name"])):m("v-if",!0),h("span",null,v(e.getText(o)),1),b(O(w,{class:"va-select-option-list__option--selected-icon",size:"small",name:"done",color:e.getColor(e.$props.color)},null,8,["color"]),[[S,e.$props.getSelectedState(o)]])],46,Y)))),128))],64)))),128)),e.filteredOptions.length?m("v-if",!0):(s(),p("div",Z,v(e.noOptionsText),1))],40,Q)},J.__file="src/components/va-select/VaSelectOptionList/VaSelectOptionList.vue";const ee=e(J);var oe=o({name:"VaSelect",components:{VaSelectOptionList:ee,VaIcon:U,VaDropdown:q,VaDropdownContent:G,VaInput:W,VaInputWrapper:z},emits:["update:modelValue","update-search","create-new","scroll-bottom",...D,...V],props:{...K,...E,...F,...R,..._,...N,modelValue:{type:[String,Number,Array,Object],default:""},placement:{type:String,default:"bottom",validator:e=>["top","bottom"].includes(e)},allowCreate:{type:[Boolean,String],default:!1,validator:e=>[!0,!1,"unique"].includes(e)},color:{type:String,default:"primary"},multiple:{type:Boolean,default:!1},searchable:{type:Boolean,default:!1},separator:{type:String,default:", "},width:{type:String,default:"100%"},maxHeight:{type:String,default:"256px"},noOptionsText:{type:String,default:"Items not found"},fixed:{type:Boolean,default:!0},hideSelected:{type:Boolean,default:!1},tabindex:{type:Number,default:0},dropdownIcon:{type:[String,Object],default:()=>({open:"expand_more",close:"expand_less"}),validator:e=>{if("string"==typeof e)return!0;const o="string"==typeof e.open,t="string"==typeof e.close;return o&&t}},outline:{type:Boolean,default:!1},bordered:{type:Boolean,default:!1},label:{type:String,default:""},placeholder:{type:String,default:""},requiredMark:{type:Boolean,default:!1}},setup(e,{emit:o}){const a=t(),s=t(),p=t(),i=A(),u=n((()=>i.value||q.value)),{getHoverColor:c,getColor:d}=P(),{getOptionByValue:v,getValue:m,getText:f,getTrackBy:g,getGroupBy:y}=M(e),{validate:h,computedError:b,computedErrorMessages:O}=L(e,o,(()=>reset()),(()=>focus())),S=n((()=>d(e.color))),x=n((()=>e.readonly?c(S.value):S.value)),C=r(""),I=n((()=>e.searchable||e.allowCreate));l(C,(e=>{o("update-search",e),K.value=null}));const k=n({get(){const o=v(e.modelValue);return e.multiple?o?Array.isArray(o)?o:[o]:[]:Array.isArray(o)&&(T("Model value should be a string or a number for a single Select."),o.length)?o[o.length-1]:o},set(e){Array.isArray(e)?o("update:modelValue",e.map(m)):o("update:modelValue",m(e))}}),j=n((()=>k.value?"string"==typeof k.value||"number"==typeof k.value?k.value:Array.isArray(k.value)?k.value.map((e=>f(e))).join(e.separator)||e.clearValue:f(k.value):e.clearValue)),B=n((()=>e.placeholder&&!j.value)),{canBeCleared:V,clearIconProps:_,onFocus:H,onBlur:N}=$(e,k),F=n((()=>e.multiple&&Array.isArray(k.value)?!!k.value.length:V.value)),D=n((()=>e.dropdownIcon?"string"==typeof e.dropdownIcon?e.dropdownIcon:q.value?e.dropdownIcon.close:e.dropdownIcon.open:"")),E=n((()=>e.options?e.hideSelected?e.options.filter((e=>!checkIsOptionSelected(e))):e.options:[])),checkIsOptionSelected=e=>!!k.value&&(Array.isArray(k.value)?!!k.value.find((o=>compareOptions(o,e))):compareOptions(k.value,e)),compareOptions=(e,o)=>{const t=m(e),r=m(o);return t===r||("string"==typeof t&&"string"==typeof r?t===r:null!==t&&null!==r&&("object"==typeof t&&"object"==typeof r&&g(t)===g(r)))},selectOption=t=>{var n;if(null!==K.value)if(I.value&&(C.value=""),e.multiple&&(n=k,Array.isArray(n.value))){const{exceedsMaxSelections:n,addOption:l}=function useMaxSelections(e,o,t){return{exceedsMaxSelections:()=>void 0!==o.value&&!isNaN(+o.value)&&e.value.length>=o.value,addOption:o=>{const r=[...e.value,o];t("update:modelValue",r)}}}(k,r(e.maxSelections),o);if(checkIsOptionSelected(m(t)))k.value=k.value.filter((e=>!compareOptions(m(t),m(e))));else{if(n())return;l(m(t))}}else k.value="string"==typeof t||"number"==typeof t?t:{...t},hideAndFocus();else hideAndFocus()},K=r(null),selectHoveredOption=()=>{K.value&&(q.value?selectOption(K.value):showDropdown())},q=r(!1),G=n({get:()=>q.value,set:e=>{e?showDropdown():hideDropdown()}}),U=n((()=>!(e.multiple||e.searchable||e.allowCreate))),showDropdown=()=>{e.disabled||e.readonly||(q.value=!0,scrollToSelected(),focusSearchOrOptions())},hideDropdown=()=>{q.value=!1,C.value="",h()},toggleDropdown=()=>{q.value?hideAndFocus():showDropdown()},hideAndFocus=()=>{hideDropdown(),i.value=!0},focusSearchBar=()=>{var e;null===(e=p.value)||void 0===e||e.focus()},focusOptionList=()=>{var o,t;null===(o=a.value)||void 0===o||o.focus(),!e.modelValue&&(null===(t=a.value)||void 0===t||t.hoverFirstOption())},focusSearchOrOptions=()=>w((()=>{I.value?focusSearchBar():focusOptionList()})),focus=()=>{var o;e.disabled||null===(o=s.value)||void 0===o||o.focus()},reset=()=>{e.multiple?k.value=Array.isArray(e.clearValue)?e.clearValue:[]:k.value=e.clearValue,C.value="",o("clear")},W=n((()=>e.disabled?-1:e.tabindex)),scrollToSelected=()=>{const e=k.value;if("object"!=typeof e&&Array.isArray(e)&&!e.length)return;const o=Array.isArray(e)?e[e.length-1]:e;K.value=o,w((()=>{var e;return null===(e=a.value)||void 0===e?void 0:e.scrollToOption(o)}))};let z,R="";const J=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight","Enter"," "];return{isFocused:u,input:s,optionList:a,searchBar:p,reset:reset,focus:focus,blur:()=>{var e;G.value&&(G.value=!1),w(null===(e=s.value)||void 0===e?void 0:e.blur)},onInputFocus:()=>{i.value=!0,H()},onInputBlur:()=>{G.value||(N(),i.value?i.value=!1:h())},focusOptionList:focusOptionList,onSelectClick:()=>{e.disabled||e.readonly||toggleDropdown()},focusSearchBar:focusSearchBar,searchInput:C,showSearchInput:I,hoveredOption:K,tabIndexComputed:W,valueComputed:k,valueComputedString:j,showClearIcon:F,toggleIcon:D,computedErrorMessages:O,computedError:b,filteredOptions:E,checkIsOptionSelected:checkIsOptionSelected,closeOnContentClick:U,selectOption:selectOption,selectOrAddOption:()=>{const t=!!e.allowCreate&&""!==C.value;null!==K.value?selectHoveredOption():t&&(()=>{var t;const r=null===(t=e.options)||void 0===t?void 0:t.some((e=>f(e)===C.value));"unique"===e.allowCreate&&r||(o("create-new",C.value),C.value="")})()},selectHoveredOption:selectHoveredOption,hoverPreviousOption:()=>{var e;null===(e=a.value)||void 0===e||e.hoverPreviousOption()},hoverNextOption:()=>{var e;null===(e=a.value)||void 0===e||e.hoverNextOption()},showDropdownContentComputed:G,showDropdown:showDropdown,hideDropdown:hideDropdown,hideAndFocus:hideAndFocus,toggleDropdown:toggleDropdown,toggleIconColor:x,onHintedSearch:o=>{if(J.some((e=>e===o.key)))return;const t=1===o.key.length,r="Backspace"===o.key||"Delete"===o.key;if(clearTimeout(z),r?R=R?R.slice(0,-1):"":t&&(R+=o.key),I.value)C.value=R;else{if(R){const o=e.options.find((e=>f(e).toLowerCase().startsWith(R.toLowerCase())));o&&(K.value=o)}z=setTimeout((()=>{R=""}),1e3)}},getText:f,getTrackBy:g,getGroupBy:y,onScrollBottom:()=>{o("scroll-bottom")},clearIconProps:_,isPlaceholder:B}}});const te={key:0,class:"va-select__placeholder"},re={class:"va-select-dropdown__options-wrapper"};oe.render=function render(e,o,t,r,n,l){const c=a("va-icon"),d=a("va-input-wrapper"),f=a("va-input"),b=a("va-select-option-list"),S=a("va-dropdown-content"),w=a("va-dropdown");return s(),y(w,{ref:"dropdown",class:"va-select__dropdown va-select-dropdown",trigger:"none",anchorSelector:".va-input-wrapper__field",placement:e.$props.placement,disabled:e.$props.disabled,"max-height":e.$props.maxHeight,fixed:e.$props.fixed,"close-on-content-click":e.closeOnContentClick,stateful:!1,offset:[1,0],"keep-anchor-width":"",modelValue:e.showDropdownContentComputed,"onUpdate:modelValue":o[6]||(o[6]=o=>e.showDropdownContentComputed=o),onKeydown:[i(u(e.showDropdown,["stop","prevent"]),["up"]),i(u(e.showDropdown,["stop","prevent"]),["down"]),i(u(e.showDropdown,["stop","prevent"]),["space"]),i(u(e.showDropdown,["stop","prevent"]),["enter"])],onClick:u(e.onSelectClick,["prevent"])},{anchor:x((()=>[O(d,{ref:"input",class:"va-select","aria-label":"selected option","model-value":e.valueComputedString,success:e.$props.success,error:e.computedError,color:e.$props.color,label:e.$props.label,loading:e.$props.loading,disabled:e.$props.disabled,outline:e.$props.outline,bordered:e.$props.bordered,"required-mark":e.$props.requiredMark,messages:e.$props.messages,"error-messages":e.computedErrorMessages,focused:e.isFocused,tabindex:e.tabIndexComputed,onFocus:e.onInputFocus,onBlur:e.onInputBlur},C({icon:x((()=>[e.showClearIcon?(s(),y(c,I({key:0,role:"button","aria-hidden":"false","aria-label":"reset",tabindex:"0"},e.clearIconProps,{onClick:u(e.reset,["stop"]),onKeydown:[i(u(e.reset,["stop"]),["enter"]),i(u(e.reset,["stop"]),["space"])]}),null,16,["onClick","onKeydown"])):m("v-if",!0)])),appendInner:x((()=>[e.$slots.appendInner?k(e.$slots,"appendInner",{key:0}):m("v-if",!0),O(c,{color:e.toggleIconColor,name:e.toggleIcon},null,8,["color","name"])])),default:x((()=>[e.isPlaceholder?(s(),p("span",te,v(e.$props.placeholder),1)):k(e.$slots,"content",j(I({key:1},{valueString:e.valueComputedString,value:e.valueComputed,tabindex:e.tabIndexComputed})),(()=>[B(v(e.valueComputedString),1)]))])),_:2},[e.$slots.prepend?{name:"prepend",fn:x((()=>[k(e.$slots,"prepend")]))}:void 0,e.$slots.append?{name:"append",fn:x((()=>[k(e.$slots,"append")]))}:void 0,e.$slots.prependInner?{name:"prependInner",fn:x((()=>[k(e.$slots,"prependInner")]))}:void 0]),1032,["model-value","success","error","color","label","loading","disabled","outline","bordered","required-mark","messages","error-messages","focused","tabindex","onFocus","onBlur"])])),default:x((()=>[O(S,{class:"va-select-dropdown__content",style:g({width:e.$props.width}),onKeyup:o[4]||(o[4]=i(u((()=>{}),["stop"]),["enter"])),onKeydown:[o[5]||(o[5]=i(u((()=>{}),["stop","prevent"]),["tab"])),i(u(e.hideAndFocus,["prevent"]),["esc"])]},{default:x((()=>[e.showSearchInput?(s(),y(f,{key:0,ref:"searchBar",class:"va-select__input",placeholder:"Search","aria-label":"options filter",tabindex:e.tabIndexComputed,bordered:!0,modelValue:e.searchInput,"onUpdate:modelValue":o[0]||(o[0]=o=>e.searchInput=o),onKeydown:[i(u(e.hoverPreviousOption,["stop","prevent"]),["up"]),i(u(e.hoverPreviousOption,["stop","prevent"]),["left"]),i(u(e.hoverNextOption,["stop","prevent"]),["down"]),i(u(e.hoverNextOption,["stop","prevent"]),["right"]),i(u(e.selectOrAddOption,["prevent"]),["enter"])],onFocus:o[1]||(o[1]=o=>e.hoveredOption=null)},null,8,["tabindex","modelValue","onKeydown"])):m("v-if",!0),h("div",re,[O(b,{ref:"optionList",hoveredOption:e.hoveredOption,"onUpdate:hoveredOption":o[2]||(o[2]=o=>e.hoveredOption=o),style:g({maxHeight:e.$props.maxHeight}),options:e.filteredOptions,"selected-value":e.valueComputed,"get-selected-state":e.checkIsOptionSelected,"get-text":e.getText,"get-track-by":e.getTrackBy,"get-group-by":e.getGroupBy,search:e.searchInput,"no-options-text":e.$props.noOptionsText,color:e.$props.color,tabindex:e.tabIndexComputed,onSelectOption:e.selectOption,onNoPreviousOptionToHover:e.focusSearchBar,onKeydown:[i(u(e.selectHoveredOption,["stop","prevent"]),["enter"]),i(u(e.selectHoveredOption,["stop","prevent"]),["space"]),o[3]||(o[3]=i(u((o=>e.searchBar&&e.searchBar.focus()),["stop","prevent"]),["tab"])),e.onHintedSearch],onScrollBottom:e.onScrollBottom},null,8,["hoveredOption","style","options","selected-value","get-selected-state","get-text","get-track-by","get-group-by","search","no-options-text","color","tabindex","onSelectOption","onNoPreviousOptionToHover","onKeydown","onScrollBottom"])])])),_:1},8,["style","onKeydown"])])),_:3},8,["placement","disabled","max-height","fixed","close-on-content-click","modelValue","onKeydown","onClick"])},oe.__file="src/components/va-select/VaSelect.vue";const ne=e(oe);export{ne as VaSelect,ee as VaSelectOptionList};
//# sourceMappingURL=index46.mjs.map
