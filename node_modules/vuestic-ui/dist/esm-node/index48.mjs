import{w as e}from"./withConfigTransport.mjs";import{defineComponent as a,shallowRef as l,ref as r,computed as t,onMounted as o,onBeforeUnmount as i,watch as s,resolveComponent as n,openBlock as u,createElementBlock as v,mergeProps as d,renderSlot as c,createCommentVNode as m,normalizeStyle as p,createTextVNode as y,toDisplayString as f,createVNode as b,createElementVNode as A,Fragment as k,renderList as g,normalizeClass as h,normalizeProps as _,guardReactiveProps as C}from"vue";import{e as x}from"./usePopover.mjs";import{w,g as L}from"./utils.mjs";import{u as V}from"./useArrayRefs.mjs";import{u as S}from"./useBem.mjs";import{u as $}from"./useColors.mjs";import"./global-config.mjs";import{VaIcon as B}from"./index31.mjs";import"./VaConfig.mjs";import"./isSymbol.mjs";import"./ssr-utils.mjs";import"./global-utils.mjs";import"./_createCompounder.mjs";import"colortranslator";import"./global-properties.mjs";import"./VaIcon.mjs";import"./useSize.mjs";const validateSlider=(e,a,l,r,t)=>{(Array.isArray(e)&&!t||!Array.isArray(e)&&t)&&w(`The type "${Array.isArray(e)?"array":typeof e}" of prop "model-value" does not match prop "range = ${t}".`),r<l&&w("The maximum value can not be less than the minimum value."),l>r&&w("The minimum value can not be greater than the maximum value."),(r-l)%a!=0&&w("Step is illegal. Slider is nondivisible.");const inRange=e=>{e<l?w(`The value of the slider is ${e}, the minimum value is ${l}, the value of this slider can not be less than the minimum value`):e>r&&w(`The value of the slider is ${e}, the maximum value is ${r}, the value of this slider can not be greater than the maximum value`)};return Array.isArray(e)?e.map(inRange):inRange(e),!0};var D=a({name:"VaSlider",components:{VaIcon:B},emits:["drag-start","drag-end","change","update:modelValue"],props:{range:{type:Boolean,default:!1},modelValue:{type:[Number,Array],default:0},trackLabel:{type:[Function,String]},color:{type:String,default:"primary"},trackColor:{type:String,default:""},labelColor:{type:String,default:""},trackLabelVisible:{type:Boolean,default:!1},min:{type:Number,default:0},max:{type:Number,default:100},step:{type:Number,default:1},label:{type:String,default:""},invertLabel:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},readonly:{type:Boolean,default:!1},pins:{type:Boolean,default:!1},iconPrepend:{type:String,default:""},iconAppend:{type:String,default:""},vertical:{type:Boolean,default:!1},showTrack:{type:Boolean,default:!0}},setup(e,{emit:a}){const{getColor:n,getHoverColor:u}=$(),v=l(),d=l(),{setItemRefByIndex:c,itemRefs:m}=V(),p=r(!1),y=r(!1),f=r(0),b=r(0),A=r(e.modelValue),k=r(0),g=r(!1),h=t((()=>e.vertical?[1,0]:[0,1])),_=t((()=>e.vertical?"bottom":"left")),C=t((()=>e.vertical?"height":"width")),w=t((()=>Array.isArray(I.value)&&I.value[1]-e.step<I.value[0])),B=t((()=>Array.isArray(I.value)&&I.value[0]+e.step>I.value[1])),D=S("va-slider",(()=>({...x(e,["disabled","readonly","vertical"]),active:p.value,horizontal:!e.vertical,grabbing:g.value}))),E=S("va-slider__handler",(()=>({onFocus:!e.range&&(y.value||p.value),inactive:!p.value}))),j=t((()=>({color:e.labelColor?n(e.labelColor):n(e.color)}))),O=t((()=>({backgroundColor:e.trackColor?n(e.trackColor):u(n(e.color))}))),T=t((()=>{const a=limitValue(e.modelValue);if(Array.isArray(a)){const l=(a[0]-e.min)/(e.max-e.min)*100,r=(a[1]-e.min)/(e.max-e.min)*100;return{[_.value]:`${l}%`,[C.value]:r-l+"%",backgroundColor:n(e.color),visibility:e.showTrack?"visible":"hidden"}}{const l=(a-e.min)/(e.max-e.min)*100;return{[C.value]:`${l}%`,backgroundColor:n(e.color),visibility:e.showTrack?"visible":"hidden"}}})),F=t((()=>{const a=limitValue(e.modelValue);if(Array.isArray(a)){const l=(a[0]-e.min)/(e.max-e.min)*100,r=(a[1]-e.min)/(e.max-e.min)*100;return[{[_.value]:`${l}%`,backgroundColor:isActiveDot(0)?n(e.color):"#ffffff",borderColor:n(e.color)},{[_.value]:`${r}%`,backgroundColor:isActiveDot(1)?n(e.color):"#ffffff",borderColor:n(e.color)}]}{const l=(a-e.min)/(e.max-e.min)*100;return{[_.value]:`${l}%`,backgroundColor:isActiveDot(0)?n(e.color):"#ffffff",borderColor:n(e.color)}}})),I=t({get:()=>e.modelValue,set:l=>{e.range||(l=limitValue(l)),y.value||a("change",l),a("update:modelValue",l)}}),R=t((()=>{const a=(e.max-e.min)/e.step;return b.value/a})),P=t((()=>{const a=`${e.step}`.split(".")[1];return a?Math.pow(10,a.length):1})),M=t((()=>(e.max-e.min)/e.step-1)),N=t((()=>Array.isArray(e.modelValue)?[(e.modelValue[0]-e.min)/e.step*R.value,(e.modelValue[1]-e.min)/e.step*R.value]:(e.modelValue-e.min)/e.step*R.value)),z=t((()=>[0,b.value])),U=t((()=>[e.min,e.max])),isActiveDot=a=>!(!p.value&&!y.value||e.disabled||e.readonly)&&(e.range?k.value===a:0===k.value),moving=a=>{g.value&&y.value&&!e.disabled&&!e.readonly&&(a.preventDefault(),setValueOnPos(getPos("touches"in a?a.touches[0]:a)))},moveEnd=()=>{if(!e.disabled&&!e.readonly){if(!y.value)return!1;a("drag-end"),a("change",e.modelValue),y.value=!1,g.value=!1}},moveWithKeys=a=>{var l,r;if(![m.value[0],m.value[1],d.value].includes(document.activeElement))return;if(e.disabled||e.readonly)return;const moveDot=(a,l,r)=>{if(a&&Array.isArray(I.value)){if(!e.pins)return I.value.splice(r,1,I.value[r]+(l?e.step:-e.step));const a=(e.max-e.min)/(M.value+1);let t=(I.value[r]/a|0)*a;I.value[r]!==t?(t+=l?a:0,I.value.splice(r,1,t)):I.value.splice(r,1,I.value[r]+(l?e.step:-e.step))}else{if(!e.pins&&!Array.isArray(I.value))return void(I.value+=l?e.step:-e.step);const a=(e.max-e.min)/(M.value+1);let r=(Array.isArray(I.value)?0:I.value/a|0)*a;I.value!==r?(r+=l?a:0,I.value=r):I.value+=l?e.step:-e.step}};["ArrowLeft","ArrowUp","ArrowRight","ArrowDown"].includes(a.key)&&a.preventDefault();const isActive=e=>e===document.activeElement;if(e.range&&Array.isArray(I.value)){const isVerticalDot0More=a=>e.vertical&&isActive(m.value[0])&&"ArrowUp"===a.key,isVerticalDot0Less=a=>e.vertical&&isActive(m.value[0])&&"ArrowDown"===a.key,isVerticalDot1More=a=>e.vertical&&isActive(m.value[1])&&"ArrowUp"===a.key,isVerticalDot1Less=a=>e.vertical&&isActive(m.value[1])&&"ArrowDown"===a.key,isHorizontalDot0Less=a=>!e.vertical&&isActive(m.value[0])&&"ArrowLeft"===a.key,isHorizontalDot0More=a=>!e.vertical&&isActive(m.value[0])&&"ArrowRight"===a.key,isHorizontalDot1Less=a=>!e.vertical&&isActive(m.value[1])&&"ArrowLeft"===a.key,isHorizontalDot1More=a=>!e.vertical&&isActive(m.value[1])&&"ArrowRight"===a.key;switch(!0){case(isVerticalDot1Less(a)||isHorizontalDot1Less(a))&&w.value&&I.value[0]!==e.min:null===(l=m.value[0])||void 0===l||l.focus(),moveDot(!0,0,0);break;case(isVerticalDot0More(a)||isHorizontalDot0More(a))&&B.value&&I.value[1]!==e.max:null===(r=m.value[1])||void 0===r||r.focus(),moveDot(!0,1,1);break;case(isVerticalDot0Less(a)||isHorizontalDot0Less(a))&&I.value[0]!==e.min:moveDot(!0,0,0);break;case(isVerticalDot1More(a)||isHorizontalDot1More(a))&&I.value[1]!==e.max:moveDot(!0,1,1);break;case(isVerticalDot1Less(a)||isHorizontalDot1Less(a))&&I.value[1]!==e.min:moveDot(!0,0,1);break;case(isVerticalDot0More(a)||isHorizontalDot0More(a))&&I.value[0]!==e.max:moveDot(!0,1,0)}}else e.vertical?("ArrowDown"===a.key&&moveDot(!1,0,0),"ArrowUp"===a.key&&moveDot(!1,1,0)):("ArrowLeft"===a.key&&moveDot(!1,0,0),"ArrowRight"===a.key&&moveDot(!1,1,0))},checkActivePin=a=>Array.isArray(I.value)?a*e.step>I.value[0]&&a*e.step<I.value[1]:a*e.step<I.value,H=t((()=>e.step/(e.max-e.min)*100)),getPos=a=>(getStaticData(),e.vertical?f.value-a.clientY:a.clientX-f.value),getStaticData=()=>{v.value&&(b.value=v.value[e.vertical?"offsetHeight":"offsetWidth"],f.value=v.value.getBoundingClientRect()[_.value])},getValueByIndex=a=>(e.step*P.value*a+e.min*P.value)/P.value,setCurrentValue=a=>{const l=k.value;if(Array.isArray(I.value)&&Array.isArray(A.value)&&Array.isArray(e.modelValue))isDiff(A.value[l],a)&&(A.value.splice(l,1,a),0===l?(I.value=[A.value.splice(l,1,a)[0],e.modelValue[1]],A.value=[...I.value]):(I.value=[e.modelValue[0],A.value.splice(l,1,a)[0]],A.value=[...I.value]));else{if(a<e.min||a>e.max)return!1;isDiff(A.value,a)&&(A.value=a,I.value=a)}},setValueOnPos=a=>{const l=z.value,r=U.value,t=Array.isArray(e.modelValue)?m.value[k.value]:d.value;if(null==t||t.focus(),a>=l[0]&&a<=l[1])if(k.value){Array.isArray(N.value)&&Array.isArray(I.value)&&a<=N.value[0]&&(I.value[1]=I.value[0],k.value=0);const e=getValueByIndex(Math.round(a/R.value));setCurrentValue(e)}else{Array.isArray(N.value)&&Array.isArray(I.value)&&a>=N.value[1]&&(I.value[0]=I.value[1],k.value=1);const e=getValueByIndex(Math.round(a/R.value));setCurrentValue(e)}else a<l[0]?setCurrentValue(r[0]):setCurrentValue(r[1])},limitValue=a=>{const inRange=a=>a<e.min?e.min:a>e.max?e.max:a;if(Array.isArray(a)){if(a[0]>=a[1]&&0===k.value){const e=inRange(a[1]);return[e,e]}if(a[0]>=a[1]&&1===k.value){const e=inRange(a[0]);return[e,e]}return a.map((e=>inRange(e)))}return inRange(a)},isDiff=(e,a)=>JSON.stringify(e)!==JSON.stringify(a),J=t((()=>`aria-label-id-${L()}`)),W=t((()=>({role:"slider",ariaValuemin:e.min,ariaValuemax:e.max,ariaLabelledby:J.value,ariaOrientation:e.vertical?"vertical":"horizontal",ariaDisabled:e.disabled,ariaReadonly:e.readonly,ariaValuenow:Array.isArray(e.modelValue)?void 0:e.modelValue})));return o((()=>{validateSlider(e.modelValue,e.step,e.min,e.max,e.range)&&(getStaticData(),document.addEventListener("mousemove",moving),document.addEventListener("touchmove",moving,{passive:!1}),document.addEventListener("mouseup",moveEnd),document.addEventListener("mouseleave",moveEnd),document.addEventListener("touchcancel",moveEnd),document.addEventListener("touchend",moveEnd),document.addEventListener("keydown",moveWithKeys))})),i((()=>{document.removeEventListener("mousemove",moving),document.removeEventListener("touchmove",moving),document.removeEventListener("mouseup",moveEnd),document.removeEventListener("mouseleave",moveEnd),document.removeEventListener("touchcancel",moveEnd),document.removeEventListener("touchend",moveEnd),document.removeEventListener("keydown",moveWithKeys)})),s([I,()=>e.step,()=>e.min,()=>e.max,()=>e.range],(([e,a,l,r,t])=>{validateSlider(e,a,l,r,t)})),s(g,(e=>{document.documentElement.style.cursor=e?"grabbing":""})),{getColor:n,dot:d,dots:m,setItemRefByIndex:c,orders:h,sliderContainer:v,val:I,getValueByOrder:a=>e.range&&void 0!==a?I.value[a]:I.value,sliderClass:D,dotClass:E,labelStyles:j,processedStyles:T,getPinStyles:a=>({backgroundColor:checkActivePin(a)?n(e.color):u(n(e.color)),[_.value]:a*H.value+"%",transition:g.value?"none":"var(--va-slider-pin-transition)"}),dottedStyles:F,getDottedStyles:a=>e.range&&void 0!==a?F.value[a]:F.value,clickOnContainer:l=>{if(e.disabled||e.readonly)return;const r=getPos("touches"in l?l.touches[0]:l);Array.isArray(N.value)&&(k.value=r>(N.value[1]-N.value[0])/2+N.value[0]?1:0),g.value=!0,setValueOnPos(r),((l,r=k.value)=>{var t,o;if(l.preventDefault(),!r)if(e.range){if(Array.isArray(N.value)){const e="touches"in l?l.touches[0]:l;r=getPos(e)>(N.value[1]-N.value[0])/2+N.value[0]?1:0}}else r=0;Array.isArray(e.modelValue)&&(k.value=r),Array.isArray(e.modelValue)?null===(t=m.value[r])||void 0===t||t.focus():null===(o=d.value)||void 0===o||o.focus(),y.value=!0,a("drag-start")})(l,k.value)},hasMouseDown:g,trackStyles:O,pinsCol:M,checkActivePin:checkActivePin,isFocused:p,isActiveDot:isActiveDot,getTrackLabel:(a,l)=>e.trackLabel?"function"==typeof e.trackLabel?e.trackLabel(a,l):e.trackLabel:a,currentSliderDotIndex:k,ariaLabelIdComputed:J,ariaAttributesComputed:W}}});const E={key:0,class:"va-slider__input-wrapper","aria-hidden":"true"},j=["id"],O={key:2,class:"va-input__label","aria-hidden":"true"},T=["tabindex","onFocus"],F=["tabindex"],I={key:3,class:"va-input__label--inverse","aria-hidden":"true"},R={key:5,class:"va-slider__input-wrapper"};D.render=function render(e,a,l,r,t,o){const i=n("va-icon");return u(),v("div",d({class:["va-slider",e.sliderClass]},e.ariaAttributesComputed),[(e.vertical?e.$slots.append:e.$slots.prepend)?(u(),v("div",E,[c(e.$slots,e.vertical?"append":"prepend")])):m("v-if",!0),!e.$slots.label&&!e.label||e.invertLabel?m("v-if",!0):(u(),v("span",{key:1,class:"va-input__label",id:e.ariaLabelIdComputed,style:p(e.labelStyles)},[c(e.$slots,"label",{},(()=>[y(f(e.label),1)]))],12,j)),(e.vertical?e.iconAppend:e.iconPrepend)?(u(),v("span",O,[b(i,{name:e.vertical?e.iconAppend:e.iconPrepend,color:e.getColor(e.$props.color),size:16},null,8,["name","color"])])):m("v-if",!0),A("div",{ref:"sliderContainer",class:"va-slider__container",onMousedown:a[3]||(a[3]=(...a)=>e.clickOnContainer&&e.clickOnContainer(...a)),onMouseup:a[4]||(a[4]=a=>e.hasMouseDown=!1),onTouchstart:a[5]||(a[5]=(...a)=>e.clickOnContainer&&e.clickOnContainer(...a))},[A("div",{class:"va-slider__track","aria-hidden":"true",style:p(e.trackStyles)},null,4),e.pins?(u(!0),v(k,{key:0},g(e.pinsCol,((a,l)=>(u(),v("div",{key:l,class:h(["va-slider__mark",{"va-slider__mark--active":e.checkActivePin(a)}]),style:p(e.getPinStyles(a))},null,6)))),128)):m("v-if",!0),e.$props.range?(u(),v(k,{key:1},[A("div",{ref:"process",class:h(["va-slider__track va-slider__track--selected",{"va-slider__track--active":e.isFocused}]),"aria-hidden":"true",style:p(e.processedStyles)},null,6),(u(!0),v(k,null,g(e.orders,(l=>(u(),v("div",{key:"dot"+l,ref_for:!0,ref:e.setItemRefByIndex(l),class:h(["va-slider__handler",e.dotClass]),style:p(e.getDottedStyles(l)),tabindex:e.disabled||e.readonly?void 0:0,onFocus:a=>(e.isFocused=!0,e.currentSliderDotIndex=l),onBlur:a[0]||(a[0]=a=>e.isFocused=!1)},[e.isActiveDot(l)?(u(),v("div",{key:0,style:p({backgroundColor:e.getColor(e.$props.color)}),class:"va-slider__handler__dot--focus"},null,4)):m("v-if",!0),e.trackLabelVisible?(u(),v("div",{key:1,style:p(e.labelStyles),class:"va-slider__handler__dot--value"},[c(e.$slots,"trackLabel",_(C({value:e.getValueByOrder(l),order:l})),(()=>[y(f(e.getTrackLabel(e.getValueByOrder(l),l)),1)]))],4)):m("v-if",!0)],46,T)))),128))],64)):(u(),v(k,{key:2},[A("div",{ref:"process","aria-hidden":"true",class:h(["va-slider__track va-slider__track--selected",{"va-slider__track--active":e.isFocused}]),style:p(e.processedStyles)},null,6),A("div",{ref:"dot",class:h(["va-slider__handler",e.dotClass]),style:p(e.dottedStyles),tabindex:e.$props.disabled||e.$props.readonly?void 0:0,onFocus:a[1]||(a[1]=a=>e.isFocused=!0),onBlur:a[2]||(a[2]=a=>e.isFocused=!1)},[e.isActiveDot(0)?(u(),v("div",{key:0,class:"va-slider__handler__dot--focus",style:p({backgroundColor:e.getColor(e.$props.color)})},null,4)):m("v-if",!0),e.trackLabelVisible?(u(),v("div",{key:1,class:"va-slider__handler__dot--value",style:p(e.labelStyles)},[c(e.$slots,"trackLabel",_(C({value:e.getValueByOrder()})),(()=>[y(f(e.getTrackLabel(e.getValueByOrder())),1)]))],4)):m("v-if",!0)],46,F)],64))],544),(e.vertical?e.iconPrepend:e.iconAppend)?(u(),v("span",I,[b(i,{name:e.vertical?e.iconPrepend:e.iconAppend,color:e.getColor(e.$props.color),size:16},null,8,["name","color"])])):m("v-if",!0),(e.$slots.label||e.label)&&e.invertLabel?(u(),v("span",{key:4,class:"va-input__label va-input__label--inverse",style:p(e.labelStyles)},[c(e.$slots,"label",{},(()=>[y(f(e.label),1)]))],4)):m("v-if",!0),(e.vertical?e.$slots.prepend:e.$slots.append)?(u(),v("div",R,[c(e.$slots,e.vertical?"prepend":"append")])):m("v-if",!0)],16)},D.__file="src/components/va-slider/VaSlider.vue";const P=e(D);export{P as VaSlider};
//# sourceMappingURL=index48.mjs.map
