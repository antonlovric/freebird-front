import{w as e}from"./withConfigTransport.mjs";import{computed as t,ref as a,watch as o,defineComponent as r,toRefs as n,nextTick as s,resolveComponent as l,openBlock as u,createElementBlock as i,createVNode as p,withCtx as m,renderSlot as c,normalizeProps as d,guardReactiveProps as v,mergeProps as f,toHandlers as y,withKeys as j,withModifiers as g,createSlots as D,createBlock as V,createCommentVNode as w,renderList as h}from"vue";import{e as b,a as P,f as C}from"./child-props.mjs";import"./global-config.mjs";import"./usePopover.mjs";import"./global-utils.mjs";import{u as I,a as k}from"./VaInput.mjs";import"colortranslator";import{u as x,b as S}from"./useStateful.mjs";import{u as $,a as _,b as F}from"./index67.mjs";import{i as T,s as B,a as O,b as L,c as A}from"./VaDatePicker.mjs";import{VaDropdown as K,VaDropdownContent as E}from"./index27.mjs";import{VaInput as N}from"./index35.mjs";import{VaIcon as W}from"./index31.mjs";import"./VaConfig.mjs";import"./global-properties.mjs";import"./isSymbol.mjs";import"./ssr-utils.mjs";import"./VaIcon.mjs";import"./useColors.mjs";import"./useSize.mjs";import"./useFocus.mjs";import"./useEmitProxy.mjs";import"./useCaptureEvent.mjs";import"./useForm.mjs";import"./useBem.mjs";import"./_createCompounder.mjs";import"cleave.js";import"./VaInputWrapper.mjs";import"./useCSSVariables.mjs";import"./useSyncProp.mjs";import"./consts.mjs";import"./index12.mjs";import"./VaButton.mjs";import"./useLoading.mjs";import"./useRouterLink.mjs";import"./useTextColor.mjs";import"./index43.mjs";import"./clamp.mjs";import"./toNumber.mjs";import"./debounce.mjs";import"./VaMessageListWrapper.mjs";var R=function isNil(e){return null==e};const defaultParseDateFunction=e=>new Date(Date.parse(e)),useDateParser=e=>{const t=a(!0),parseDate=a=>{const o=(e.parseDate||defaultParseDateFunction)(a);var r;return t.value=T(r=o)&&!isNaN(r.getTime()),o};return{parseDateInputValue:a=>{if(t.value=!0,e.parse)return e.parse(a,t);if((t=>t.includes(e.delimiter))(a))return a.split(e.delimiter).map(parseDate);if((t=>t.includes(e.rangeDelimiter))(a)){const[t,o]=a.split(e.rangeDelimiter).map(parseDate);return{start:t,end:o}}return parseDate(a)},isValid:t}},isRange=e=>"object"==typeof e&&("start"in e||"end"in e),parseSingleDate=e=>"string"==typeof e?defaultParseDateFunction(e):new Date(e),parseModelValue=e=>Array.isArray(e)?e.map(parseSingleDate):isRange(e)?{start:R(e.start)?e.start:parseSingleDate(e.start),end:R(e.end)?e.end:parseSingleDate(e.end)}:parseSingleDate(e),useRangeModelValueGuard=(e,r,n=parseModelValue)=>{const s=a(e.value&&n(e.value)),l=t({get:()=>s.value,set:t=>{r.value&&(e.value=t),t?(isRange(t)?null!==t.end&&(e.value=t):e.value=t,s.value=t):e.value=t}});o(e,(e=>{s.value=e}));return{valueComputed:l,reset:()=>{s.value&&isRange(s.value)&&(s.value=e.value&&n(e.value))}}},z=b(N,["mask","returnRaw","autosize","minRows","maxRows","type","inputmode","counter","maxLength"]),H=b(B);var M=r({name:"VaDateInput",components:{VaDropdown:K,VaDropdownContent:E,VaDatePicker:B,VaInput:N,VaIcon:W},props:{...z,...H,...$,clearValue:{type:Date,default:void 0},modelValue:{type:[Date,Array,Object,String,Number]},resetOnClose:{type:Boolean,default:!0},isOpen:{type:Boolean,default:void 0},format:{type:Function},formatDate:{type:Function,default:e=>e.toLocaleDateString()},parse:{type:Function},parseDate:{type:Function},parseValue:{type:Function},delimiter:{type:String,default:", "},rangeDelimiter:{type:String,default:" ~ "},manualInput:{type:Boolean,default:!1},color:{type:String,default:"primary"},leftIcon:{type:Boolean,default:!1},icon:{type:String,default:"calendar_today"}},emits:[...P(B),...I,..._,...x,"update:is-open","update:text"],setup(e,{emit:r,slots:l}){const u=a(),i=a(),{isOpen:p,resetOnClose:m}=n(e),{valueComputed:c}=S(e,r),{syncProp:d}=function useSyncProp(e,o,r,n){if(void 0===n)return{syncProp:t({set(e){r(`update:${o}`,e)},get:()=>e.value})};const s=a(n);return{syncProp:t({set(e){s.value=e,r(`update:${o}`,e)},get:()=>void 0===(null==e?void 0:e.value)?s.value:e.value})}}(p,"is-open",r,!1),v=t((()=>!m.value)),{valueComputed:f,reset:y}=useRangeModelValueGuard(c,v,e.parseValue);o(d,(e=>{e||v.value||y()}));const dateOrNothing=t=>t?e.formatDate(t):"...",{parseDateInputValue:j,isValid:g}=useDateParser(e);o(f,(()=>{g.value=!0}));const modelValueToString=t=>{if(e.format)return e.format(f.value);if(O(t))return t.map((t=>e.formatDate(t))).join(e.delimiter);if(L(t))return e.formatDate(t);if(A(t))return dateOrNothing(t.start)+e.rangeDelimiter+dateOrNothing(t.end);throw new Error("VaDatePicker: Invalid model value. Value should be Date, Date[] or { start: Date, end: Date | null }")},{text:D,value:V}=(w=f,h=j,P=modelValueToString,{text:t({get(){const e=w.value;return"string"==typeof e?e:P(e)},set(e){"string"==typeof w.value?w.value=e:w.value=h(e)}}),value:t({get:()=>"string"==typeof w.value?h(w.value):w.value,set(e){"string"==typeof w.value?w.value=P(e):w.value=e}})});var w,h,P;const I=t((()=>g.value?f.value?D.value:e.clearValue?modelValueToString(e.clearValue):"":"")),reset=()=>{c.value=e.clearValue,r("clear")},focus=()=>{var e;null===(e=u.value)||void 0===e||e.focus()},focusDatePicker=()=>{s((()=>{var e;return null===(e=i.value)||void 0===e?void 0:e.focusCurrentPicker()}))},focusInputOrPicker=()=>{d.value?focusDatePicker():focus()},{computedError:x,computedErrorMessages:$,listeners:_}=F(e,r,reset,focus),T=t((()=>!g.value&&f.value!==e.clearValue||x.value)),K=t((()=>{const t=[e.leftIcon&&"prependInner",(!e.leftIcon||e.clearable)&&"icon"];return Object.keys(l).filter((e=>!t.includes(e)))})),{canBeCleared:E,clearIconProps:N,onFocus:W,onBlur:R}=k(e,f),H=t((()=>({name:e.icon,color:e.color,size:"small",class:"va-date-input__icon"}))),M=t((()=>({...C(e,z).value,clearable:!1,rules:[],error:T.value,errorMessages:$.value,readonly:e.readonly||!e.manualInput}))),U=t((()=>({focus:()=>{W(),_.onFocus()},blur:()=>{R(),_.onBlur()}})));return{datePicker:i,valueText:I,valueWithoutText:V,valueComputed:f,isOpenSync:d,onInputTextChanged:({target:e})=>{const t=j(e.value);g.value&&(f.value=t)},input:u,inputProps:M,inputListeners:U,datePickerProps:C(e,b(B)),filterSlots:K,canBeCleared:E,clearIconProps:N,iconProps:H,hideAndFocus:()=>{d.value=!1,focus()},showAndFocus:t=>{e.manualInput||(d.value=!0,focusDatePicker(),t.preventDefault())},toggleDropdown:()=>{d.value=!d.value,s(focusInputOrPicker)},showDropdown:()=>{d.value=!0,s(focusInputOrPicker)},focusInputOrPicker:focusInputOrPicker,reset:reset,focus:focus,blur:()=>{var e;null===(e=u.value)||void 0===e||e.blur()}}}});const U={class:"va-date-input"};M.render=function render(e,t,a,o,r,n){const s=l("va-icon"),b=l("va-input"),P=l("va-date-picker"),C=l("va-dropdown-content"),I=l("va-dropdown");return u(),i("div",U,[p(I,{modelValue:e.isOpenSync,"onUpdate:modelValue":t[13]||(t[13]=t=>e.isOpenSync=t),trigger:"none",anchorSelector:".va-input-wrapper__field",offset:[2,0],"close-on-content-click":!1,stateful:!1,disabled:e.disabled},{anchor:m((()=>[c(e.$slots,"input",d(v({valueText:e.valueText,inputProps:e.inputProps,inputListeners:e.inputListeners})),(()=>[p(b,f({ref:"input",class:"va-date-input__input"},e.inputProps,y(e.inputListeners),{"model-value":e.valueText,"aria-label":"selected date",onChange:e.onInputTextChanged,onClick:t[3]||(t[3]=t=>e.toggleDropdown()),onKeydown:[j(g(e.showAndFocus,["stop"]),["enter"]),j(g(e.showAndFocus,["stop"]),["space"])]}),D({prependInner:m((t=>[c(e.$slots,"prependInner",d(v(t))),e.$props.leftIcon?(u(),V(s,d(f({key:0},e.iconProps)),null,16)):w("v-if",!0)])),icon:m((()=>[e.canBeCleared?(u(),V(s,f({key:0,"aria-hiden":"false",role:"button","aria-label":"reset",tabindex:"0",class:"va-date-input__clear-icon"},e.clearIconProps,{onClick:t[0]||(t[0]=t=>e.reset()),onKeydown:[t[1]||(t[1]=j(g((t=>e.reset()),["stop"]),["enter"])),t[2]||(t[2]=j(g((t=>e.reset()),["stop"]),["space"]))]}),null,16)):e.$props.leftIcon?w("v-if",!0):(u(),V(s,f({key:1},e.iconProps,{tabindex:"0",onKeydown:[j(g(e.showDropdown,["stop"]),["enter"]),j(g(e.showDropdown,["stop"]),["space"])]}),null,16,["onKeydown"]))])),_:2},[h(e.filterSlots,(t=>({name:t,fn:m((a=>[c(e.$slots,t,d(v(a)))]))})))]),1040,["model-value","onChange","onKeydown"])]))])),default:m((()=>[p(C,{onKeydown:t[12]||(t[12]=j(g((t=>e.hideAndFocus()),["stop","prevent"]),["esc"]))},{default:m((()=>[p(P,f({ref:"datePicker"},e.datePickerProps,{modelValue:e.valueWithoutText,"onUpdate:modelValue":t[4]||(t[4]=t=>e.valueWithoutText=t),"onClick:day":t[5]||(t[5]=t=>e.$emit("click:day",t)),"onClick:month":t[6]||(t[6]=t=>e.$emit("click:month",t)),"onClick:year":t[7]||(t[7]=t=>e.$emit("click:year",t)),"onHover:day":t[8]||(t[8]=t=>e.$emit("hover:day",t)),"onHover:month":t[9]||(t[9]=t=>e.$emit("hover:month",t)),"onHover:year":t[10]||(t[10]=t=>e.$emit("hover:year",t)),"onUpdate:view":t[11]||(t[11]=t=>e.$emit("update:view",t))}),D({_:2},[h(e.$slots,((t,a)=>({name:a,fn:m((t=>[c(e.$slots,a,d(v(t)))]))})))]),1040,["modelValue"])])),_:3})])),_:3},8,["modelValue","disabled"])])},M.__file="src/components/va-date-input/VaDateInput.vue";const q=e(M);export{q as VaDateInput};
//# sourceMappingURL=index24.mjs.map
