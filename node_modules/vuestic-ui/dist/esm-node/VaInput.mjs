import{computed as e,getCurrentInstance as t,shallowRef as a,onMounted as r,onUpdated as o,onBeforeUnmount as l,ref as n,watch as u,defineComponent as s,nextTick as i,openBlock as p,createElementBlock as d,mergeProps as c,toRefs as m,resolveComponent as v,createBlock as g,createSlots as b,withCtx as y,withModifiers as f,withKeys as h,createCommentVNode as x,renderSlot as V,normalizeProps as w,guardReactiveProps as k,renderList as $}from"vue";import{s as C,o as S}from"./VaIcon.mjs";import{e as I}from"./usePopover.mjs";import{e as P,f as R}from"./child-props.mjs";import"./global-config.mjs";import"./global-utils.mjs";import{a as B}from"./useFocus.mjs";import"colortranslator";import{u as _}from"./useEmitProxy.mjs";import{u as j}from"./useCaptureEvent.mjs";import{u as E}from"./useForm.mjs";import{u as F,a as z,b as L}from"./index67.mjs";import A from"cleave.js";import{s as H}from"./VaInputWrapper.mjs";const M={clearable:{type:Boolean,default:!1},clearableIcon:{type:String,default:"highlight_off"},clearValue:{type:String,default:""}},q=["clear"],useClearable=(t,a,r,o)=>{const{isFocused:l,onFocus:n,onBlur:u}=B(r),s=[null,void 0,t.clearValue],i=e((()=>t.clearable&&!t.disabled&&!t.readonly&&!s.includes(a.value))),p=e((()=>(null==l?void 0:l.value)?t.color||"primary":(null==o?void 0:o.value)?"danger":t.success?"success":"secondary")),d=e((()=>({name:t.clearableIcon,color:p.value,size:"small"})));return{canBeCleared:i,clearIconColor:p,clearIconProps:d,onFocus:n,onBlur:u}},useFocusDeep=n=>{const u=(()=>{const e=a(),updateActiveElement=()=>{e.value=document.activeElement};return r(updateActiveElement),j("focus",updateActiveElement),j("blur",updateActiveElement),e})(),s=(e=>{if(e)return e;const n=t(),u=a();return r((()=>{var e;u.value=null!==(e=n.proxy.$el)&&void 0!==e?e:void 0})),o((()=>{var e;u.value=null!==(e=n.proxy.$el)&&void 0!==e?e:void 0})),l((()=>{var e;u.value=null!==(e=n.proxy.$el)&&void 0!==e?e:void 0})),u})(n);let i=null;return e({get(){var e;if(!u.value)return!1;if(u.value===s.value)return!0;const t=null===(e=s.value)||void 0===e?void 0:e.contains(u.value);return t&&(i=u.value),t},set(e){const t=null!=i?i:s.value;e?null==t||t.focus():null==t||t.blur()}})},N={creditCard:{creditCard:!0},date:{date:!0,datePattern:["d","m","Y"]},time:{time:!0,timePattern:["h","m"],timeFormat:"24"},numeral:{numeral:!0,numeralThousandsGroupStyle:"thousand"}},T={mask:{type:[String,Object],default:""},returnRaw:{type:Boolean,default:!0},modelValue:{type:String}},useCleave=(t,a,o)=>{const s=n(),destroyCleave=()=>{s.value&&s.value.destroy()},initCleave=()=>{var e;(destroyCleave(),t.value)&&(s.value=new A(t.value,"string"==typeof(e=a.mask)?N[e]?{...N[e]}:{}:{...e}))};r((()=>{initCleave()})),l((()=>{destroyCleave()})),u((()=>[t.value,a.mask]),(()=>{initCleave()}));const i=e((()=>s.value&&a.returnRaw&&a.modelValue===s.value.getRawValue()?s.value.getFormattedValue():a.modelValue));return{cleave:s,computedValue:i,onInput:e=>{const t=e.target.value;("string"===a.mask||Object.keys(a.mask).length)&&s.value&&(s.value.setRawValue(t),a.returnRaw)?o("update:modelValue",s.value.getRawValue()):o("update:modelValue",t)}}},O=["letter-spacing","line-height","padding-top","padding-bottom","font-family","font-weight","font-size","text-rendering","text-transform","width","text-indent","padding-left","padding-right","border-width","box-sizing"],getNodeHeightStyles=e=>{const t=window.getComputedStyle(e);return{boxSizing:t.getPropertyValue("box-sizing")||t.getPropertyValue("-moz-box-sizing")||t.getPropertyValue("-webkit-box-sizing"),padding:parseFloat(t.getPropertyValue("padding-bottom"))+parseFloat(t.getPropertyValue("padding-top")),border:parseFloat(t.getPropertyValue("border-bottom-width"))+parseFloat(t.getPropertyValue("border-top-width")),styles:O.map((e=>`${e}:${t.getPropertyValue(e)}`)).join(";")+";",lineHeight:parseInt(t.getPropertyValue("line-height"))}};let W=null;const createHiddenTextarea=(e,t)=>{W||(W=document.createElement("textarea")),W.setAttribute("style",t+"\n  min-height:0 !important;\n  max-height:none !important;\n  height:0 !important;\n  visibility:hidden !important;\n  overflow:hidden !important;\n  position:absolute !important;\n  z-index:-1000 !important;\n  top:0 !important;\n  right:0 !important';\n"),W.value=e.value||e.placeholder||"";const a=e.getAttribute("wrap");return null!==a?W.setAttribute("wrap",a):W.removeAttribute("wrap"),W},positiveNumberValidator=e=>{if(e>0&&(0|e)===e)return!0;throw new Error(`\`minRows|maxRows\` must be a positive integer greater than 0, but ${e} is provided`)},{createEmits:K,createListeners:D}=_(["input","change","click","update:modelValue"]);var G=s({name:"VaTextarea",props:{...E,modelValue:{type:[String,Number],default:""},placeholder:{type:String},autosize:{type:Boolean,default:!1},minRows:{type:Number,default:1,validator:positiveNumberValidator},maxRows:{type:Number,validator:positiveNumberValidator}},emits:K(),setup(t,{emit:o}){const l=a(),s=n(-1),p=n(-1),{calculateRowHeight:d,calculateHeight:c}=(e=>({calculateRowHeight:()=>e.value?getNodeHeightStyles(e.value).lineHeight:0,calculateHeight:()=>{if(!e.value)return 0;const{boxSizing:t,padding:a,border:r,styles:o}=getNodeHeightStyles(e.value),l=createHiddenTextarea(e.value,o);document.body.appendChild(l);let n=l.scrollHeight;return"border-box"===t?n+=r:"content-box"===t&&(n-=a),document.body.removeChild(l),n}}))(l),m=e((()=>Boolean((t.autosize||t.maxRows||1!==t.minRows)&&l.value))),updateHeight=()=>{m.value&&(p.value=c())};r((()=>{m.value&&(s.value=d()),updateHeight()})),u((()=>t.modelValue),(()=>{i(updateHeight)}));const v=e((()=>({minHeight:s.value*t.minRows+"px",maxHeight:t.maxRows?s.value*t.maxRows+"px":void 0,height:p.value+"px",resize:m.value?void 0:"none"}))),g=e((()=>({...I(t,["disabled","readonly","placeholder","ariaLabel"])})));return{textarea:l,computedStyle:v,listeners:D(o),computedProps:g,focus:()=>{var e;null===(e=l.value)||void 0===e||e.focus()},blur:()=>{var e;null===(e=l.value)||void 0===e||e.blur()}}}});const Y=["value"];G.render=function render$1(e,t,a,r,o,l){return p(),d("textarea",c({ref:"textarea",class:"textarea",style:e.computedStyle},{...e.computedProps,...e.listeners},{value:e.modelValue}),null,16,Y)},G.__file="src/components/va-input/components/VaTextarea/VaTextarea.vue";const J=P(G),{createEmits:Q,createListeners:U}=_(["change","keyup","keypress","keydown","focus","blur"]),{createEmits:X,createListeners:Z}=_(["click","click-prepend","click-append","click-prepend-inner","click-append-inner"]);var ee=s({name:"VaInput",components:{VaInputWrapper:H,VaTextarea:G,VaIcon:C},props:{...E,...F,...M,...T,...J,placeholder:{type:String,default:""},tabindex:{type:Number,default:0},modelValue:{type:[String,Number],default:""},label:{type:String,default:""},type:{type:String,default:"text"},loading:{type:Boolean,default:!1},inputClass:{type:String,default:""},pattern:{type:String},inputmode:{type:String,default:"text"},ariaLabel:{type:String,default:void 0},counter:{type:Boolean,default:!1},maxLength:{type:Number,default:void 0},color:{type:String,default:"primary"},outline:{type:Boolean,default:!1},bordered:{type:Boolean,default:!1},requiredMark:{type:Boolean,default:!1}},emits:["update:modelValue",...z,...q,...Q(),...X()],inheritAttrs:!1,setup(t,{emit:r,attrs:o,slots:l}){const n=a(),u=useFocusDeep(),reset=()=>{r("update:modelValue",t.clearValue),r("clear")},focus=()=>{var e;null===(e=n.value)||void 0===e||e.focus()},s=e((()=>{const e=["icon"];return Object.keys(l).filter((t=>!e.includes(t)))})),{computedError:i,computedErrorMessages:p,listeners:d}=L(t,r,reset,focus),{modelValue:c}=m(t),{canBeCleared:v,clearIconProps:g}=useClearable(t,c,n,i),b=e((()=>"textarea"===t.type?void 0:n.value)),{computedValue:y,onInput:f}=useCleave(b,t,r),h=U(r),x={...h,onFocus:e=>{h.onFocus(e),d.onFocus()},onBlur:e=>{h.onBlur(e),d.onBlur()},onInput:f},V=e((()=>t.disabled?-1:t.tabindex)),w=e((()=>({ariaLabel:t.ariaLabel||t.label,ariaRequired:t.requiredMark,ariaDisabled:t.disabled,ariaReadOnly:t.readonly,"aria-invalid":!!p.value.length,"aria-errormessage":"string"==typeof p.value?p.value:p.value.join(", "),tabindex:V.value,class:t.inputClass,...S(o,["class","style"])}))),k=e((()=>({...w.value,...I(t,["type","disabled","readonly","placeholder","pattern","inputmode"])}))),$=e((()=>t.counter&&"string"==typeof y.value?y.value.length:void 0));return{input:n,inputEvents:x,valueLengthComputed:$,computedChildAttributes:w,computedInputAttributes:k,textareaProps:R(t,J),computedValue:y,tabIndexComputed:V,computedError:i,computedErrorMessages:p,isFocused:u,canBeCleared:v,clearIconProps:g,fieldListeners:Z(r),filterSlots:s,reset:reset,focus:focus,blur:()=>{var e;null===(e=n.value)||void 0===e||e.blur()}}}});const te=["value"];ee.render=function render(e,t,a,r,o,l){const n=v("va-icon"),u=v("VaTextarea"),s=v("VaInputWrapper");return p(),g(s,c(e.fieldListeners,{class:e.$attrs.class,style:e.$attrs.style,color:e.$props.color,readonly:e.$props.readonly,disabled:e.$props.disabled,success:e.$props.success,messages:e.$props.messages,error:e.computedError,"error-messages":e.computedErrorMessages,"error-count":e.errorCount,label:e.$props.label,bordered:e.$props.bordered,outline:e.$props.outline,requiredMark:e.$props.requiredMark,focused:e.isFocused,"counter-value":e.valueLengthComputed,"max-length":e.$props.maxLength,onClick:e.focus}),b({icon:y((t=>[e.canBeCleared?(p(),g(n,c({key:0,role:"button","aria-hidden":"false","aria-label":"reset",class:"va-input__icons__reset",tabindex:e.tabIndexComputed},e.clearIconProps,{onClick:f(e.reset,["stop"]),onKeydown:[h(f(e.reset,["stop"]),["enter"]),h(f(e.reset,["stop"]),["space"])]}),null,16,["tabindex","onClick","onKeydown"])):x("v-if",!0),e.$props.loading?(p(),g(n,{key:1,color:e.$props.color,size:"small",name:"loop",spin:"counter-clockwise"},null,8,["color"])):x("v-if",!0),V(e.$slots,"icon",w(k(t)))])),default:y((()=>["textarea"!==e.type||e.$slots.content?e.$slots.content?x("v-if",!0):(p(),d("input",c({key:1,ref:"input",class:"va-input__content__input"},{...e.computedInputAttributes,...e.inputEvents},{value:e.computedValue}),null,16,te)):(p(),g(u,c({key:0,ref:"input"},{...e.computedChildAttributes,...e.textareaProps,...e.inputEvents},{class:"va-input__content__input"}),null,16))])),_:2},[$(e.filterSlots,(t=>({name:t,fn:y((a=>[V(e.$slots,t,w(k(a)))]))})))]),1040,["class","style","color","readonly","disabled","success","messages","error","error-messages","error-count","label","bordered","outline","requiredMark","focused","counter-value","max-length","onClick"])},ee.__file="src/components/va-input/VaInput.vue";export{useClearable as a,M as b,useFocusDeep as c,ee as s,q as u};
//# sourceMappingURL=VaInput.mjs.map
