import{w as e}from"./withConfigTransport.mjs";import{defineComponent as l,resolveComponent as o,openBlock as i,createElementBlock as a,createVNode as t,withCtx as n,createElementVNode as r,createTextVNode as u,ref as d,createBlock as s,normalizeClass as m,toDisplayString as p,withKeys as v,withModifiers as f,computed as c,onMounted as g,watch as y,createCommentVNode as F,normalizeStyle as _,Fragment as V,renderList as b,shallowRef as h,renderSlot as U}from"vue";import"./global-config.mjs";import"./usePopover.mjs";import"./global-utils.mjs";import{e as S,u as j}from"./useColors.mjs";import{VaButton as B}from"./index12.mjs";import{VaCard as C}from"./index13.mjs";import{VaIcon as k}from"./index31.mjs";import{V as D}from"./VaModal.mjs";import"./VaConfig.mjs";import"./global-properties.mjs";import"./isSymbol.mjs";import"./ssr-utils.mjs";import"colortranslator";import"./VaButton.mjs";import"./useLoading.mjs";import"./useRouterLink.mjs";import"./useSize.mjs";import"./useTextColor.mjs";import"./index43.mjs";import"./clamp.mjs";import"./toNumber.mjs";import"./VaIcon.mjs";import"./useAlign.mjs";import"./useStateful.mjs";var I=l({name:"VaFileUploadUndo",components:{VaButton:B},emits:["recover"]});const L={class:"va-file-upload-undo"},R=r("span",null,"File was successfully deleted",-1),x=u(" Undo ");I.render=function render$5(e,l,r,u,d,s){const m=o("va-button");return i(),a("div",L,[R,t(m,{class:"va-file-upload-undo__button",size:"small",outline:"",onClick:l[0]||(l[0]=l=>e.$emit("recover"))},{default:n((()=>[x])),_:1})])},I.__file="src/components/va-file-upload/VaFileUploadUndo/VaFileUploadUndo.vue";const z=e(I);var T=l({name:"VaFileUploadListItem",components:{VaIcon:k,VaCard:C,VaFileUploadUndo:z},emits:["remove"],props:{file:{type:Object,default:null},color:{type:String,default:"success"},undo:{type:Boolean,default:!1},undoDuration:{type:Number,default:3e3}},setup(e,{emit:l}){const o=d(!1);return{removed:o,removeFile:()=>{e.undo?(o.value=!0,setTimeout((()=>{o.value&&(l("remove"),o.value=!1)}),e.undoDuration)):(l("remove"),o.value=!1)},recoverFile:()=>{o.value=!1}}}});const w={key:1,class:"va-file-upload-list-item__content"},$={class:"va-file-upload-list-item__name"},A={class:"va-file-upload-list-item__size"};T.render=function render$4(e,l,u,d,c,g){const y=o("va-file-upload-undo"),F=o("va-icon"),_=o("va-card");return i(),s(_,{class:m(["va-file-upload-list-item",{"file-upload-list-item--undo":e.removed}]),stripe:e.removed&&e.undo,stripeColor:e.color,"no-margin":"","no-padding":""},{default:n((()=>[e.removed&&e.undo?(i(),s(y,{key:0,onRecover:e.recoverFile},null,8,["onRecover"])):(i(),a("div",w,[r("div",$,p(e.file&&e.file.name),1),r("div",A,p(e.file&&e.file.size),1),t(F,{class:"va-file-upload-list-item__delete",name:"clear",role:"button","aria-hidden":"false","aria-label":"remove file",tabindex:"0",color:"danger",onClick:e.removeFile,onKeydown:[v(f(e.removeFile,["stop"]),["enter"]),v(f(e.removeFile,["stop"]),["space"])]},null,8,["onClick","onKeydown"])]))])),_:1},8,["class","stripe","stripeColor"])},T.__file="src/components/va-file-upload/VaFileUploadListItem/VaFileUploadListItem.vue";const M=e(T);var G=l({name:"VaFileUploadGalleryItem",components:{VaFileUploadUndo:z,VaButton:B},emits:["remove"],props:{file:{type:Object,default:null},color:{type:String,default:"success"},undo:{type:Boolean,default:!1},undoDuration:{type:Number,default:3e3}},setup(e,{emit:l}){const o=d(""),i=d(!1),a=d(!1),t=c((()=>({backgroundColor:S(e.color,.7)}))),convertToImg=()=>{if(e.file.name&&e.file.image)if(e.file.image.url)o.value=e.file.image.url;else if(e.file.image instanceof File){const l=new FileReader;l.readAsDataURL(e.file.image),l.onload=e=>{var l,i;(null===(l=e.target)||void 0===l?void 0:l.result).includes("image")&&(o.value=null===(i=e.target)||void 0===i?void 0:i.result)}}};return g(convertToImg),y((()=>e.file),convertToImg),{previewImage:o,removed:i,isFocused:a,recoverImage:()=>{i.value=!1},overlayStyles:t,removeImage:()=>{e.undo?(i.value=!0,setTimeout((()=>{i.value&&(l("remove"),i.value=!1)}),e.undoDuration)):(l("remove"),i.value=!1)}}}});const H=["src"],N={class:"va-file-upload-gallery-item__overlay"},O=["title"];G.render=function render$3(e,l,n,u,d,s){const v=o("va-file-upload-undo"),f=o("va-button");return e.removed&&e.undo?(i(),a("div",{key:0,class:m(["va-file-upload-gallery-item",{"va-file-upload-gallery-item--undo":e.removed}])},[t(v,{class:"va-file-upload-gallery-item--undo",onRecover:e.recoverImage},null,8,["onRecover"])],2)):(i(),a("div",{key:1,tabindex:"0",class:m(["va-file-upload-gallery-item",{"file-upload-gallery-item_not-image":!e.previewImage,"va-file-upload-gallery-item--focused":e.isFocused}]),onFocus:l[2]||(l[2]=l=>e.isFocused=!0),onBlur:l[3]||(l[3]=l=>e.isFocused=!1)},[e.previewImage?(i(),a("img",{key:0,src:e.previewImage,alt:"",class:"va-file-upload-gallery-item__image"},null,8,H)):F("v-if",!0),r("div",N,[r("div",{class:"va-file-upload-gallery-item__overlay-background",style:_(e.overlayStyles)},null,4),r("div",{class:"va-file-upload-gallery-item__name",title:e.file.name},p(e.file.name),9,O),t(f,{flat:"",color:"danger",icon:"delete_outline",class:"va-file-upload-gallery-item__delete","aria-label":"remove image",onClick:e.removeImage,onFocus:l[0]||(l[0]=l=>e.isFocused=!0),onBlur:l[1]||(l[1]=l=>e.isFocused=!1)},null,8,["onClick"])])],34))},G.__file="src/components/va-file-upload/VaFileUploadGalleryItem/VaFileUploadGalleryItem.vue";const K=e(G);var Z=l({name:"VaFileUploadSingleItem",components:{VaButton:B},emits:["remove"],props:{file:{type:Object,default:null}}});const P={class:"va-file-upload-single-item"},E={class:"va-file-upload-single-item__name"},Y=u(" Delete ");Z.render=function render$2(e,l,u,d,s,m){const v=o("va-button");return i(),a("div",P,[r("div",E,p(e.file&&e.file.name),1),t(v,{class:"va-file-upload-single-item__button",size:"small",color:"danger",flat:"",onClick:l[0]||(l[0]=l=>e.$emit("remove"))},{default:n((()=>[Y])),_:1})])},Z.__file="src/components/va-file-upload/VaFileUploadSingleItem/VaFileUploadSingleItem.vue";const q=e(Z);var J=l({name:"VaFileUploadList",components:{VaFileUploadListItem:M,VaFileUploadGalleryItem:K,VaFileUploadSingleItem:q},emits:["remove","removeSingle"],props:{type:{type:String,default:""},files:{type:Array,default:null},color:{type:String,default:"success"},undo:{type:Boolean,default:!1},undoDuration:{type:Number,default:3e3}},setup(e){const l=c((()=>e.files.map(convertFile))),convertFile=e=>({name:e.name||e.url||"",size:formatSize(e.size),date:formatDate(new Date),image:e}),formatSize=e=>{if(0===e)return"0 Bytes";if(!e)return"";const l=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,l)).toFixed(2))+" "+["Bytes","KB","MB","GB","TB","PB","EB","ZB","YB"][l]},formatDate=(e=new Date)=>e.toLocaleDateString("en-US",{hour:"2-digit",minute:"2-digit",month:"short",day:"numeric",year:"numeric"});return{filesList:l}}});const Q=["role"];J.render=function render$1(e,l,t,n,r,u){const d=o("va-file-upload-list-item"),p=o("va-file-upload-gallery-item"),v=o("va-file-upload-single-item");return i(),a("div",{class:m(["va-file-upload-list",`va-file-upload-list--${e.type}`]),role:"single"!==e.type?"list":void 0},["list"===e.type?(i(!0),a(V,{key:0},b(e.filesList,((l,o)=>(i(),s(d,{key:l.name,role:"listitem",file:l,color:e.color,undo:e.undo,undoDuration:e.undoDuration,onRemove:l=>e.$emit("remove",o)},null,8,["file","color","undo","undoDuration","onRemove"])))),128)):F("v-if",!0),"gallery"===e.type?(i(!0),a(V,{key:1},b(e.filesList,((l,o)=>(i(),s(p,{role:"listitem",file:l,key:l.name,color:e.color,undo:e.undo,undoDuration:e.undoDuration,onRemove:l=>e.$emit("remove",o)},null,8,["file","color","undo","undoDuration","onRemove"])))),128)):F("v-if",!0),"single"===e.type&&e.filesList.length?(i(),s(v,{key:2,file:e.filesList[e.filesList.length-1],onRemove:l[0]||(l[0]=l=>e.$emit("removeSingle"))},null,8,["file"])):F("v-if",!0)],10,Q)},J.__file="src/components/va-file-upload/VaFileUploadList/VaFileUploadList.vue";const W=e(J);var X=l({name:"VaFileUpload",components:{VaModal:D,VaButton:B,VaFileUploadList:W},props:{fileTypes:{type:String,default:""},dropzone:{type:Boolean,default:!1},hideFileList:{type:Boolean,default:!1},color:{type:String,default:"primary"},disabled:{type:Boolean,default:!1},undo:{type:Boolean,default:!1},undoDuration:{type:Number,default:3e3},dropZoneText:{type:String,default:"Drag’n’drop files or"},uploadButtonText:{type:String,default:"Upload file"},modelValue:{type:[Object,Array],default:()=>[]},type:{type:String,default:"list",validator:e=>["list","gallery","single"].includes(e)}},emits:["update:modelValue","file-removed","file-added"],setup(e,{emit:l}){const o=h(),i=d(!1),a=d(!1),{getColor:t,shiftHSLAColor:n}=j(),r=c((()=>t(e.color))),u=c((()=>({backgroundColor:e.dropzone?n(r.value,{a:a.value?-.82:-.92}):"transparent"}))),s=c({get:()=>Array.isArray(e.modelValue)?e.modelValue:[e.modelValue],set(o){"single"===e.type?l("update:modelValue",o[0]):l("update:modelValue",o)}}),validateFiles=l=>l.filter((l=>{const o=l.name||l.url;if(!o)return!1;if(l.url)return!0;if(["audio/*","video/*","image/*"].find((l=>e.fileTypes.includes(l))))return!0;const a=o.substring(o.lastIndexOf(".")+1).toLowerCase(),t=e.fileTypes.includes(a);return t||(i.value=!0),t})),uploadFile=o=>{var i,a;const t=(null===(i=o.target)||void 0===i?void 0:i.files)||(null===(a=o.dataTransfer)||void 0===a?void 0:a.files);if(!t)return;const n=e.fileTypes?validateFiles(Array.from(t)):t;s.value="single"===e.type?n:[...s.value,...n],l("file-added",n)};return g((()=>{Array.isArray(s.value)&&(s.value=validateFiles(s.value))})),{modal:i,dropzoneHighlight:a,fileInputRef:o,colorComputed:r,computedStyle:u,uploadFile:uploadFile,changeFieldValue:e=>{uploadFile(e),o.value&&(o.value.value="")},files:s,removeFile:e=>{if(e in s.value){const o=s.value[e];s.value=s.value.filter(((l,o)=>o!==e)),l("file-removed",o)}},removeSingleFile:()=>{if(s.value.length>0){const e=s.value[0];s.value=[],l("file-removed",e)}},callFileDialogue:()=>{o.value&&o.value.click()}}}});const ee={class:"va-file-upload__field"},le={key:0,class:"va-file-upload__field__text"},oe=["accept","multiple","disabled"];X.render=function render(e,l,d,v,f,c){const g=o("va-button"),y=o("va-file-upload-list"),V=o("va-modal");return i(),a("div",{class:m(["va-file-upload",{"va-file-upload--dropzone":e.dropzone}]),style:_(e.computedStyle)},[U(e.$slots,"default",{},(()=>[r("div",ee,[e.dropzone?(i(),a("div",le,p(e.dropZoneText),1)):F("v-if",!0),t(g,{class:"va-file-upload__field__button",disabled:e.disabled,color:e.colorComputed,style:_({"pointer-events":e.dropzoneHighlight?"none":""}),onChange:e.changeFieldValue,onClick:e.callFileDialogue},{default:n((()=>[u(p(e.uploadButtonText),1)])),_:1},8,["disabled","color","style","onChange","onClick"])])])),r("input",{ref:"fileInputRef",type:"file",class:"va-file-upload__field__input",tabindex:-1,"aria-hidden":"true",accept:e.fileTypes,multiple:"single"!==e.type,disabled:e.disabled,onChange:l[0]||(l[0]=(...l)=>e.changeFieldValue&&e.changeFieldValue(...l)),onDragenter:l[1]||(l[1]=l=>e.dropzoneHighlight=!0),onDragleave:l[2]||(l[2]=l=>e.dropzoneHighlight=!1)},null,40,oe),e.files.length&&!e.$props.hideFileList?(i(),s(y,{key:0,type:e.type,files:e.files,color:e.colorComputed,undo:e.undo,undoDuration:e.undoDuration,onRemove:e.removeFile,onRemoveSingle:e.removeSingleFile},null,8,["type","files","color","undo","undoDuration","onRemove","onRemoveSingle"])):F("v-if",!0),t(V,{modelValue:e.modal,"onUpdate:modelValue":l[3]||(l[3]=l=>e.modal=l),"hide-default-actions":"",title:"File validation",message:"File type is incorrect!"},null,8,["modelValue"])],6)},X.__file="src/components/va-file-upload/VaFileUpload.vue";const ie=e(X);export{ie as VaFileUpload,K as VaFileUploadGalleryItem,W as VaFileUploadList,M as VaFileUploadListItem,q as VaFileUploadSingleItem,z as VaFileUploadUndo};
//# sourceMappingURL=index28.mjs.map
