import{w as e}from"./withConfigTransport.mjs";import{computed as t,watch as l,ref as a,defineComponent as o,resolveComponent as n,openBlock as s,createBlock as r,mergeProps as i,withCtx as c,createElementVNode as u,createElementBlock as d,renderSlot as m,normalizeProps as v,guardReactiveProps as g,createCommentVNode as f,normalizeClass as p,Fragment as b,renderList as y,normalizeStyle as S,withModifiers as w,withKeys as h,toDisplayString as C,createVNode as k,TransitionGroup as R,createTextVNode as x}from"vue";import{_,o as $}from"./VaIcon.mjs";import{t as B,e as V}from"./usePopover.mjs";import{_ as A}from"./_createCompounder.mjs";import{r as I}from"./global-config.mjs";import{a as H}from"./utils.mjs";import{s as j}from"./css-utils.mjs";import"./global-utils.mjs";import{u as F}from"./useColors.mjs";import{VaInnerLoading as P}from"./index34.mjs";import{VaCheckbox as O}from"./index15.mjs";import{VaIcon as T}from"./index31.mjs";import"./VaConfig.mjs";import"./useSize.mjs";import"./isSymbol.mjs";import"./ssr-utils.mjs";import"./global-properties.mjs";import"colortranslator";import"./useLoading.mjs";import"./useKeyboardOnlyFocus.mjs";import"./useSelectable.mjs";import"./useStateful.mjs";import"./index67.mjs";import"./useSyncProp.mjs";import"./useFocus.mjs";import"./consts.mjs";import"./useTextColor.mjs";import"./VaMessageListWrapper.mjs";var M=_;var D=function castSlice$1(e,t,l){var a=e.length;return l=void 0===l?a:l,!t&&l>=a?e:M(e,t,l)},N=RegExp("[\\u200d\\ud800-\\udfff\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff\\ufe0e\\ufe0f]");var L=function hasUnicode$2(e){return N.test(e)};var K=function asciiToArray$1(e){return e.split("")},U="[\\ud800-\\udfff]",z="[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]",E="\\ud83c[\\udffb-\\udfff]",W="[^\\ud800-\\udfff]",q="(?:\\ud83c[\\udde6-\\uddff]){2}",G="[\\ud800-\\udbff][\\udc00-\\udfff]",J="(?:"+z+"|"+E+")"+"?",Q="[\\ufe0e\\ufe0f]?"+J+("(?:\\u200d(?:"+[W,q,G].join("|")+")[\\ufe0e\\ufe0f]?"+J+")*"),X="(?:"+[W+z+"?",z,q,G,U].join("|")+")",Y=RegExp(E+"(?="+E+")|"+X+Q,"g");var Z=K,ee=L,te=function unicodeToArray$1(e){return e.match(Y)||[]};var le=D,ae=L,oe=function stringToArray$1(e){return ee(e)?te(e):Z(e)},ne=B;var se=function createCaseFirst$1(e){return function(t){t=ne(t);var l=ae(t)?oe(t):void 0,a=l?l[0]:t.charAt(0),o=l?le(l,1).join(""):t.slice(1);return a[e]()+o}}("toUpperCase"),re=A((function(e,t,l){return e+(l?" ":"")+se(t)}));const buildTableColumn=(e,t)=>{const l="string"==typeof e?{key:e}:e;return{source:e,initialIndex:t,key:l.key,name:l.name||l.key,label:l.label||re(l.key),thTitle:l.thTitle||l.headerTitle||l.label||re(l.key),sortable:l.sortable||!1,sortingFn:l.sortingFn,thAlign:l.thAlign||l.alignHead||"left",thVerticalAlign:l.thVerticalAlign||l.verticalAlignHead||"middle",tdAlign:l.tdAlign||l.align||"left",tdVerticalAlign:l.tdVerticalAlign||l.verticalAlign||"middle",width:l.width,tdClass:l.tdClass||l.classes,thClass:l.thClass||l.headerClasses,tdStyle:l.tdStyle||l.style,thStyle:l.thStyle||l.headerStyle}};function useColumns(e){return{columnsComputed:t((()=>{return 0===e.columns.length?(t=e.items,Object.keys(I({},...t)).map(buildTableColumn)):e.columns.map(buildTableColumn);var t}))}}const getItemKey=(e,t)=>"function"==typeof t?t(e):H(e,t)||e,buildTableRow=(e,t,l,a)=>{const o=getItemKey(e,l);return{initialIndex:t,itemKey:o,source:e,cells:a.map((l=>((e,t,l,a)=>{var o;const n=H(l,a.key);return{rowIndex:e,rowKey:t,rowData:l,column:a,source:n,value:(null===(o=null==n?void 0:n.toString)||void 0===o?void 0:o.call(n))||""}})(t,o,e,l)))}};function useSelectableRow(e,o,n){const s=a([]),r=t({get:()=>void 0===o.modelValue?s.value:o.modelValue,set(e){void 0===o.modelValue&&(s.value=e),n("update:modelValue",e)}}),i=a(-1);l((()=>o.selectMode),((e,t)=>{"single"===e&&"multiple"===t&&(r.value=[],setPrevSelectedRowIndex(-1))})),l(e,(()=>{setPrevSelectedRowIndex(-1)})),l(r,((e,t=[])=>{n("selectionChange",{currentSelectedItems:e,previousSelectedItems:t})}),{immediate:!0});const getKey=e=>getItemKey(e,o.itemsTrackBy),c=t((()=>!e.value.some((({source:e})=>r.value.includes(getKey(e)))))),u=t((()=>0!==e.value.length&&e.value.every((({source:e})=>r.value.includes(getKey(e)))))),d=t((()=>!c.value&&!u.value));function isRowSelected(e){return r.value.includes(getKey(e.source))}function setPrevSelectedRowIndex(t){if(-1===t)i.value=-1;else{const l=e.value.find((e=>e.initialIndex===t));i.value=l?e.value.indexOf(l):-1}}function toggleRowSelection(e){o.selectable&&(isRowSelected(e)?(!function unselectRow(e){const t=r.value.findIndex((t=>t===getKey(e.source)));r.value=[...r.value.slice(0,t),...r.value.slice(t+1)]}(e),"single"===o.selectMode?setPrevSelectedRowIndex(-1):setPrevSelectedRowIndex(e.initialIndex)):("single"===o.selectMode?function selectOnlyRow(e){r.value=[getKey(e.source)]}(e):function selectRow(e){r.value=[...r.value,getKey(e.source)]}(e),setPrevSelectedRowIndex(e.initialIndex)))}return{ctrlSelectRow:function ctrlSelectRow(e){o.selectable&&toggleRowSelection(e)},shiftSelectRows:function shiftSelectRows(t){if(!o.selectable)return;if("single"===o.selectMode||-1===i.value)return toggleRowSelection(t);!function mergeSelection(e){const t=e.map((e=>getKey(e.source)));if(c.value)return void(r.value=t);t.every((e=>r.value.includes(e)))?r.value=r.value.filter((e=>!t.includes(e))):r.value=[...new Set([...r.value,...t])]}(function getRowsToSelect(t){let l,a;return isRowSelected(e.value[i.value])?(l=Math.min(i.value,t),a=Math.max(i.value,t)):(l=Math.min(i.value+1,t),a=Math.max(i.value-1,t)),e.value.slice(l,a+1)}(e.value.indexOf(t))),setPrevSelectedRowIndex(-1)},toggleRowSelection:toggleRowSelection,toggleBulkSelection:function toggleBulkSelection(){u.value?function unselectAllRows(){const t=e.value.map((e=>getKey(e.source)));r.value=r.value.filter((e=>!t.includes(e)))}():function selectAllRows(){r.value=[...new Set([...r.value,...e.value.map((e=>getKey(e.source)))])]}(),setPrevSelectedRowIndex(-1)},isRowSelected:isRowSelected,noRowsSelected:c,severalRowsSelected:d,allRowsSelected:u}}const ie="--va-data-table",isFunction$1=e=>"function"==typeof e,getClass=e=>isFunction$1(e)?e():e,getStyle=e=>isFunction$1(e)?e():e;function useStyleable(e){const{getColor:l,getFocusColor:a,getHoverColor:o,shiftHSLAColor:n}=F(),s=t((()=>l(e.selectedColor)));return{rowCSSVariables:t((()=>({[`${ie}-hover-color`]:o(s.value),[`${ie}-selected-color`]:e.selectable?a(s.value):void 0}))),stickyCSSVariables:t((()=>({[`${ie}-scroll-table-color`]:(e.height||e.stickyHeader||e.stickyFooter)&&n(s.value,{l:40}),[`${ie}-scroll-table-height`]:e.height?j(e.height):void 0}))),getHeaderCSSVariables:e=>({[`${ie}-width`]:e.width&&j(e.width),[`${ie}-align`]:e.thAlign,[`${ie}-vertical-align`]:e.thVerticalAlign,[`${ie}-cursor`]:e.sortable?"pointer":"default"}),getCellCSSVariables:e=>({[`${ie}-align`]:e.column.tdAlign,[`${ie}-vertical-align`]:e.column.tdVerticalAlign}),getFooterCSSVariables:t=>({[`${ie}-align`]:t.thAlign,[`${ie}-vertical-align`]:t.thVerticalAlign,[`${ie}-cursor`]:e.allowFooterSorting&&t.sortable?"pointer":"default"}),getClass:getClass,getStyle:getStyle}}const isFunction=e=>"function"==typeof e,isObject=e=>null!==e&&"object"==typeof e;var ce=o({name:"VaDataTable",components:{VaInnerLoading:P,VaCheckbox:O,VaIcon:T},inheritAttrs:!1,props:{columns:{type:Array,default:()=>[]},items:{type:Array,default:()=>[]},itemsTrackBy:{type:[String,Function],default:""},modelValue:{type:Array},sortingOrder:{type:String},sortBy:{type:String},filter:{type:String,default:""},filterMethod:{type:Function},hoverable:{type:Boolean,default:!1},clickable:{type:Boolean,default:!1},animated:{type:Boolean,default:!0},selectable:{type:Boolean,default:!1},selectMode:{type:String,default:"multiple"},selectedColor:{type:String,default:"primary"},perPage:{type:Number},currentPage:{type:Number},loading:{type:Boolean,default:!1},loadingColor:{type:String,default:"primary"},noDataHtml:{type:String,default:"No items"},noDataFilteredHtml:{type:String,default:"No items match the provided filtering condition"},hideDefaultHeader:{type:Boolean,default:!1},footerClone:{type:Boolean,default:!1},allowFooterSorting:{type:Boolean,default:!1},striped:{type:Boolean,default:!1},stickyHeader:{type:Boolean,default:!1},stickyFooter:{type:Boolean,default:!1},height:{type:[String,Number]},rowBind:{type:null},cellBind:{type:null}},emits:["update:modelValue","update:sortBy","update:sortingOrder","filtered","sorted","selectionChange","row:click","row:dblclick","row:contextmenu"],setup(e,{attrs:o,emit:n}){const{columnsComputed:s}=useColumns(e),{rowsComputed:r}=function useRows(e,l){return{rowsComputed:t((()=>l.items.map(((t,a)=>buildTableRow(t,a,l.itemsTrackBy,e.value)))))}}(s,e),{filteredRows:i}=function useFilterable(e,a,o){const n=t((()=>e.value.length&&(""!==a.filter||a.filterMethod)?e.value.filter((e=>e.cells.some((e=>"function"==typeof a.filterMethod?a.filterMethod(e.source):e.value.toLowerCase().includes(a.filter.toLowerCase()))))):e.value));return l(n,(()=>{o("filtered",{items:n.value.map((e=>e.source)),itemsIndexes:n.value.map((e=>e.initialIndex))})})),{filteredRows:n}}(r,e,n),{sortBySync:c,sortingOrderSync:u,toggleSorting:d,sortedRows:m}=function useSortable(e,o,n,s){const r=a(""),i=t({get:()=>void 0===n.sortBy?r.value:n.sortBy,set(e){void 0===n.sortBy&&(r.value=e),s("update:sortBy",e)}}),c=a(null),u=t({get:()=>void 0===n.sortingOrder?c.value:n.sortingOrder,set(e){void 0===n.sortingOrder&&(c.value=e),s("update:sortingOrder",e)}}),d=t((()=>{if(o.value.length<=1)return o.value;const t=e.value.find((e=>e.name===i.value));if(!t||!t.sortable)return o.value;const l=e.value.indexOf(t);return[...o.value].sort(((e,a)=>{const o=e.cells[l].value,n=a.cells[l].value,s=e.cells[l].source,r=a.cells[l].source;return null===u.value?e.initialIndex-a.initialIndex:("desc"===u.value?-1:1)*("function"==typeof t.sortingFn?t.sortingFn(s,r):o.localeCompare(n))}))}));return l(d,(()=>{s("sorted",{sortBy:i.value,sortingOrder:u.value,items:d.value.map((e=>e.source)),itemsIndexes:d.value.map((e=>e.initialIndex))})})),{sortBySync:i,sortingOrderSync:u,toggleSorting:function toggleSorting(e){e.name===i.value?null===u.value?u.value="asc":"asc"===u.value?u.value="desc":u.value=null:(i.value=e.name,u.value="asc")},sortedRows:d}}(s,i,e,n),{paginatedRows:v}=function usePaginatedRows$1(e,l){return{paginatedRows:t((()=>{if(!l.perPage||l.perPage<0)return e.value;if(!l.currentPage||l.currentPage<0)return e.value.slice(0,l.perPage);const t=l.perPage*(l.currentPage-1);return e.value.slice(t,t+l.perPage)}))}}(m,e),{ctrlSelectRow:g,shiftSelectRows:f,toggleBulkSelection:p,isRowSelected:b,severalRowsSelected:y,allRowsSelected:S}=useSelectableRow(v,e,n),{rowCSSVariables:w,stickyCSSVariables:h,getHeaderCSSVariables:C,getCellCSSVariables:k,getFooterCSSVariables:R,getClass:x,getStyle:_}=useStyleable(e),{getRowBind:B,getCellBind:A}=function useBinding(e){return{getRowBind:t=>isFunction(e.rowBind)?e.rowBind(t.source,t.initialIndex):isObject(e.rowBind)?e.rowBind:{},getCellBind:(t,l)=>isFunction(e.cellBind)?e.cellBind(t.source,l.source,t.column,l.initialIndex):isObject(e.cellBind)?e.cellBind:{}}}(e),I=function usePaginatedRows(e,o){const n=a("table-transition-shuffle"),s=a(o.value.length),r=t((()=>o.value.length!==s.value));return l(o,(t=>{const l=r.value||t.length>50?"fade":"shuffle";n.value=e.animated?`table-transition-${l}`:"",s.value=t.length})),l((()=>e.currentPage),(()=>{r.value||(n.value=e.animated?"table-transition-shuffle":"")})),n}(e,v),H=t((()=>0===e.items.length)),j=t((()=>0===v.value.length)),F=t((()=>({class:[{"va-data-table--sticky":e.stickyHeader||e.stickyFooter},{"va-data-table--scroll":!!e.height},o.class],style:[h.value,o.style]}))),P=t((()=>({...$(o,["class","style"]),class:V(e,["striped","selectable","hoverable","clickable"])})));return{columnsComputed:s,rows:v,ctrlSelectRow:g,shiftSelectRows:f,toggleBulkSelection:p,isRowSelected:b,severalRowsSelected:y,allRowsSelected:S,sortBySync:c,sortingOrderSync:u,toggleSorting:d,rowCSSVariables:w,getHeaderCSSVariables:C,getCellCSSVariables:k,getFooterCSSVariables:R,getClass:x,getStyle:_,showNoDataHtml:H,showNoDataFilteredHtml:j,onRowClickHandler:(t,l,a)=>{e.clickable&&n(t,{event:l,item:a.source,itemIndex:a.initialIndex})},computedAttributes:F,computedTableAttributes:P,animationName:I,getColumnAriaSortOrder:e=>u.value&&c.value===e?"asc"===u.value?"ascending":"descending":"none",getRowBind:B,getCellBind:A}}});const ue={key:0},de={key:0,class:"va-data-table__table-tr"},me={key:0,scope:"col",class:"va-data-table__table-th va-data-table__table-cell-select"},ve=["aria-sort","aria-label","title","onClick","onKeydown"],ge=["tabindex"],fe={key:0},pe={key:"showNoDataHtml"},be=["colspan","innerHTML"],ye={key:"showNoDataFilteredHtml"},Se=["colspan","innerHTML"],we=["onClick","onDblclick","onContextmenu"],he={key:0,class:"va-data-table__table-tr"},Ce={key:0,class:"va-data-table__table-th"},ke=["title","aria-label","onClick","onKeydown"],Re=["tabindex"],xe={key:0};ce.render=function render(e,t,l,a,o,_){const $=n("va-checkbox"),B=n("va-icon"),V=n("va-inner-loading");return s(),r(V,i({class:"va-data-table","aria-live":"polite"},e.computedAttributes,{loading:e.loading,color:e.loadingColor}),{default:c((()=>[u("table",i({class:"va-data-table__table"},e.computedTableAttributes),["colgroup"in e.$slots?(s(),d("colgroup",ue,[m(e.$slots,"colgroup",v(g(e.columnsComputed)))])):f("v-if",!0),u("thead",{class:p(["va-data-table__table-thead",{"va-data-table__table-thead--sticky":e.$props.stickyHeader}])},[m(e.$slots,"headerPrepend"),e.hideDefaultHeader?f("v-if",!0):(s(),d("tr",de,[e.selectable?(s(),d("th",me,["multiple"===e.selectMode?(s(),r($,{key:0,"aria-label":"select all rows","model-value":e.severalRowsSelected?"idl":e.allRowsSelected,"true-value":!0,"false-value":!1,color:e.selectedColor,"indeterminate-value":"idl",indeterminate:"","onUpdate:modelValue":e.toggleBulkSelection},null,8,["model-value","color","onUpdate:modelValue"])):f("v-if",!0)])):f("v-if",!0),(s(!0),d(b,null,y(e.columnsComputed,(l=>(s(),d("th",{key:l.name,scope:"col","aria-sort":e.getColumnAriaSortOrder(l.name),"aria-label":l.sortable?`sort column by ${l.label}`:void 0,title:l.thTitle,class:p(["va-data-table__table-th",e.getClass(l.thClass)]),style:S([e.getHeaderCSSVariables(l),e.getStyle(l.thStyle)]),onClick:w((t=>l.sortable&&e.toggleSorting(l)),["exact"]),onKeydown:h(w((t=>l.sortable&&e.toggleSorting(l)),["stop"]),["enter"])},[u("div",{class:"va-data-table__table-th-wrapper",tabindex:l.sortable?0:-1},[`header(${l.name})`in e.$slots?(s(),d("span",fe,[m(e.$slots,`header(${l.name})`,v(g({label:l.label,key:l.key})))])):m(e.$slots,"header",v(i({key:1},{label:l.label,key:l.key})),(()=>[u("span",null,C(l.label),1)])),l.sortable?(s(),d("div",{key:2,class:"va-data-table__table-th-sorting","aria-hidden":"true",onSelectstart:t[0]||(t[0]=w((()=>{}),["prevent"]))},[k(B,{name:"asc"===e.sortingOrderSync?"expand_less":"expand_more",size:"small",class:p(["va-data-table__table-th-sorting-icon",{active:e.sortBySync===l.name&&null!==e.sortingOrderSync}])},null,8,["name","class"])],32)):f("v-if",!0)],8,ge)],46,ve)))),128))])),m(e.$slots,"headerAppend")],2),u("tbody",{class:"va-data-table__table-tbody",style:S(e.rowCSSVariables)},[m(e.$slots,"bodyPrepend"),k(R,{name:e.animationName,appear:""},{default:c((()=>[e.showNoDataHtml?(s(),d("tr",pe,[u("td",{colspan:e.columnsComputed.length+(e.selectable?1:0),innerHTML:e.noDataHtml,class:"no-data"},null,8,be)])):e.showNoDataFilteredHtml?(s(),d("tr",ye,[u("td",{colspan:e.columnsComputed.length+(e.selectable?1:0),innerHTML:e.noDataFilteredHtml,class:"no-data"},null,8,Se)])):f("v-if",!0),(s(!0),d(b,null,y(e.rows,(l=>(s(),d("tr",i({key:`table-row_${l.initialIndex}`,class:["va-data-table__table-tr",[{selected:e.isRowSelected(l)}]]},e.getRowBind(l),{onClick:t=>e.onRowClickHandler("row:click",t,l),onDblclick:t=>e.onRowClickHandler("row:dblclick",t,l),onContextmenu:t=>e.onRowClickHandler("row:contextmenu",t,l)}),[e.selectable?(s(),d("td",{class:"va-data-table__table-td va-data-table__table-cell-select",key:`selectable_${l.initialIndex}`,onSelectstart:t[1]||(t[1]=w((()=>{}),["prevent"]))},[k($,{"model-value":e.isRowSelected(l),color:e.selectedColor,"aria-label":`select row ${l.initialIndex}`,onClick:[w((t=>e.shiftSelectRows(l)),["shift","exact","stop"]),w((t=>e.ctrlSelectRow(l)),["ctrl","exact","stop"]),w((t=>e.ctrlSelectRow(l)),["exact","stop"])]},null,8,["model-value","color","aria-label","onClick"])],32)):f("v-if",!0),(s(!0),d(b,null,y(l.cells,(t=>(s(),d("td",i({key:`table-cell_${t.column.name+t.rowIndex}`,class:["va-data-table__table-td",e.getClass(t.column.tdClass)],style:[e.getCellCSSVariables(t),e.getStyle(t.column.tdStyle)]},e.getCellBind(t,l)),[`cell(${t.column.name})`in e.$slots?m(e.$slots,`cell(${t.column.name})`,v(i({key:0},t))):m(e.$slots,"cell",v(i({key:1},t)),(()=>[x(C(t.value),1)]))],16)))),128))],16,we)))),128))])),_:3},8,["name"]),m(e.$slots,"bodyAppend")],4),e.footerClone?(s(),d("tfoot",{key:1,class:p(["va-data-table__table-tfoot",{"va-data-table__table-tfoot--sticky":e.$props.stickyFooter}])},[m(e.$slots,"footerPrepend"),e.hideDefaultHeader?f("v-if",!0):(s(),d("tr",he,[e.selectable?(s(),d("th",Ce,["multiple"===e.selectMode?(s(),r($,{key:0,"aria-label":"select all rows","model-value":e.severalRowsSelected?"idl":e.allRowsSelected,"true-value":!0,"false-value":!1,color:e.selectedColor,"indeterminate-value":"idl",indeterminate:"","onUpdate:modelValue":e.toggleBulkSelection},null,8,["model-value","color","onUpdate:modelValue"])):f("v-if",!0)])):f("v-if",!0),(s(!0),d(b,null,y(e.columnsComputed,(l=>(s(),d("th",{key:l.name,title:l.thTitle,"aria-label":e.allowFooterSorting&&l.sortable?`sort column by ${l.label}`:void 0,class:p(["va-data-table__table-th",e.getClass(l.thClass)]),style:S([e.getFooterCSSVariables(l),e.getStyle(l.thStyle)]),onClick:w((t=>e.allowFooterSorting&&l.sortable&&e.toggleSorting(l)),["exact"]),onKeydown:h(w((t=>e.allowFooterSorting&&l.sortable&&e.toggleSorting(l)),["stop"]),["enter"])},[u("div",{class:"va-data-table__table-th-wrapper",tabindex:e.allowFooterSorting&&l.sortable?0:-1},[`footer(${l.name})`in e.$slots?(s(),d("span",xe,[m(e.$slots,`footer(${l.name})`,v(g({label:l.label,key:l.key})))])):m(e.$slots,"footer",v(i({key:1},l)),(()=>[u("span",null,C(l.label),1)])),e.allowFooterSorting&&l.sortable?(s(),d("div",{key:2,class:"va-data-table__table-th-sorting",onSelectstart:t[2]||(t[2]=w((()=>{}),["prevent"]))},[k(B,{name:"asc"===e.sortingOrderSync?"expand_less":"expand_more",size:"small",class:p(["va-data-table__table-th-sorting-icon",{active:e.sortBySync===l.name&&null!==e.sortingOrderSync}])},null,8,["name","class"])],32)):f("v-if",!0)],8,Re)],46,ke)))),128))])),m(e.$slots,"footerAppend")],2)):f("v-if",!0)],16)])),_:3},16,["loading","color"])},ce.__file="src/components/va-data-table/VaDataTable.vue";const _e=e(ce);export{_e as VaDataTable};
//# sourceMappingURL=index23.mjs.map
