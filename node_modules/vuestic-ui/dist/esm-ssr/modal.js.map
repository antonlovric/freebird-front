{"version":3,"file":"modal.js","sources":["../../src/components/va-modal/modal.ts"],"sourcesContent":["import { VaModal } from './VaModal'\nimport type { ModalOptions } from './types'\nimport { VNode, render, AppContext, h, nextTick } from 'vue'\n\ntype OptionKeys = keyof ModalOptions;\n\nconst getNodeProps = (vNode: VNode): Record<OptionKeys, any> => {\n  return (vNode.component?.props as Record<OptionKeys, any>) || {}\n}\n\nconst destroy = (el: HTMLElement | null | undefined, vNode: VNode | null) => {\n  if (el) {\n    render(null, el)\n    el.remove()\n  }\n\n  el = null\n  vNode = null\n}\n\nconst mount = (\n  component: any,\n  { props, appContext }: { props?: ModalOptions; appContext?: AppContext } = {},\n): { vNode: VNode; el?: HTMLElement } => {\n  const el: HTMLElement | undefined = document?.createElement('div')\n\n  // eslint-disable-next-line prefer-const\n  let vNode: VNode | null\n\n  // handling the case when 'withoutTransitions = false'\n  const onClose = (event: HTMLElement) => {\n    props?.onClose?.(event)\n    destroy(el, vNode)\n  }\n\n  // handling the case when 'withoutTransitions = true'\n  const onUpdateModelValue = (value: boolean) => {\n    props?.['onUpdate:modelValue']?.(value)\n\n    if (props?.withoutTransitions && !value) {\n      nextTick(() => { // this is required for all handlers to execute\n        destroy(el, vNode)\n      })\n    }\n  }\n\n  vNode = h(component, {\n    ...props,\n    stateful: props?.stateful ?? true,\n    modelValue: true,\n    onClose,\n    'onUpdate:modelValue': onUpdateModelValue,\n  })\n\n  if (appContext) {\n    vNode.appContext = appContext\n  }\n\n  if (el) {\n    render(vNode, el)\n  }\n\n  return { vNode, el }\n}\n\nconst getModalOptions = (options: string | ModalOptions): ModalOptions => typeof options === 'string'\n  ? { message: options }\n  : options\n\nexport const createModalInstance = (customProps: ModalOptions | string, appContext?: AppContext): VNode => {\n  const { vNode, el } = mount(VaModal, { appContext, props: getModalOptions(customProps) })\n\n  if (el && vNode.el && getNodeProps(vNode)) {\n    document.body.appendChild(el.childNodes[0])\n  }\n\n  return vNode\n}\n"],"names":["destroy","el","vNode","render","remove","createModalInstance","customProps","appContext","component","props","document","createElement","h","stateful","_a","modelValue","onClose","event","call","value","withoutTransitions","nextTick","mount","VaModal","options","message","getNodeProps","body","appendChild","childNodes"],"mappings":"mFAMA,MAIMA,QAAU,CAACC,EAAoCC,KAC/CD,IACFE,EAAO,KAAMF,GACbA,EAAGG,UAGLH,EAAK,MAqDMI,oBAAsB,CAACC,EAAoCC,KACtE,MAAML,MAAEA,EAAKD,GAAEA,GAlDH,EACZO,GACEC,MAAAA,EAAOF,WAAAA,GAAkE,YAE3E,MAAMN,EAAsC,OAARS,eAAQ,IAARA,cAAQ,EAARA,SAAUC,cAAc,OAG5D,IAAIT,EAmCJ,OAhBAA,EAAQU,EAAEJ,EAAW,IAChBC,EACHI,SAAyB,QAAfC,EAAAL,MAAAA,SAAAA,EAAOI,gBAAQ,IAAAC,GAAAA,EACzBC,YAAY,EACZC,QApBeC,UACD,QAAdH,EAAAL,MAAAA,OAAA,EAAAA,EAAOO,eAAO,IAAAF,GAAAA,EAAAI,KAAAT,EAAGQ,GACjBjB,QAAQC,IAmBR,sBAf0BkB,UACI,QAA9BL,EAAAL,MAAAA,OAAA,EAAAA,EAAQ,8BAAsB,IAAAK,GAAAA,EAAAI,KAAAT,EAAGU,IAE7BV,MAAAA,OAAK,EAALA,EAAOW,sBAAuBD,GAChCE,GAAS,KACPrB,QAAQC,SAaVM,IACFL,EAAMK,WAAaA,GAGjBN,GACFE,EAAOD,EAAOD,GAGT,CAAEC,MAAAA,EAAOD,GAAAA,IAQMqB,CAAMC,EAAS,CAAEhB,WAAAA,EAAYE,OAL5Be,EAKmDlB,EALiB,iBAAZkB,EAC7E,CAAEC,QAASD,GACXA,KAFoB,IAACA,EAWvB,OAJIvB,GAAMC,EAAMD,IAlEG,CAACC,UACpB,OAAyB,UAAjBA,EAAMM,iBAAW,IAAAM,OAAA,EAAAA,EAAAL,QAAqC,IAiExCiB,CAAaxB,IACjCQ,SAASiB,KAAKC,YAAY3B,EAAG4B,WAAW,IAGnC3B"}