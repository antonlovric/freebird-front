import{w as e}from"./withConfigTransport.js";import{computed as t,ref as o,watch as a,defineComponent as n,toRefs as r,nextTick as l,resolveComponent as s,mergeProps as i,withCtx as u,toHandlers as p,createSlots as c,renderSlot as d,openBlock as m,createBlock as v,createCommentVNode as f,withKeys as y,withModifiers as h,renderList as k,createVNode as w}from"vue";import{e as j,a as g,f as P}from"./child-props.js";import"./global-config.js";import"./usePopover.js";import"./global-utils.js";import{u as C,a as V}from"./VaInput.js";import"colortranslator";import{u as x,b as $}from"./useStateful.js";import{u as D,a as b,b as I}from"./index67.js";import{i as _,s as S,a as T,b as F,c as B}from"./VaDatePicker.js";import{VaDropdown as H,VaDropdownContent as K}from"./index27.js";import{VaInput as L}from"./index35.js";import{VaIcon as O}from"./index31.js";import{ssrRenderAttrs as U,ssrRenderComponent as W,ssrRenderSlot as A}from"@vue/server-renderer";import"./VaConfig.js";import"./global-properties.js";import"./isSymbol.js";import"./ssr-utils.js";import"./VaIcon.js";import"./useColors.js";import"./useSize.js";import"./useFocus.js";import"./useEmitProxy.js";import"./useCaptureEvent.js";import"./useForm.js";import"./useBem.js";import"./_createCompounder.js";import"cleave.js";import"./VaInputWrapper.js";import"./useCSSVariables.js";import"./useSyncProp.js";import"./consts.js";import"./index12.js";import"./VaButton.js";import"./useLoading.js";import"./useRouterLink.js";import"./useTextColor.js";import"./index43.js";import"./clamp.js";import"./toNumber.js";import"./debounce.js";import"./VaMessageListWrapper.js";var R=function isNil(e){return null==e};const defaultParseDateFunction=e=>new Date(Date.parse(e)),useDateParser=e=>{const t=o(!0),parseDate=o=>{const a=(e.parseDate||defaultParseDateFunction)(o);var n;return t.value=_(n=a)&&!isNaN(n.getTime()),a};return{parseDateInputValue:o=>{if(t.value=!0,e.parse)return e.parse(o,t);if((t=>t.includes(e.delimiter))(o))return o.split(e.delimiter).map(parseDate);if((t=>t.includes(e.rangeDelimiter))(o)){const[t,a]=o.split(e.rangeDelimiter).map(parseDate);return{start:t,end:a}}return parseDate(o)},isValid:t}},isRange=e=>"object"==typeof e&&("start"in e||"end"in e),parseSingleDate=e=>"string"==typeof e?defaultParseDateFunction(e):new Date(e),parseModelValue=e=>Array.isArray(e)?e.map(parseSingleDate):isRange(e)?{start:R(e.start)?e.start:parseSingleDate(e.start),end:R(e.end)?e.end:parseSingleDate(e.end)}:parseSingleDate(e),useRangeModelValueGuard=(e,n,r=parseModelValue)=>{const l=o(e.value&&r(e.value)),s=t({get:()=>l.value,set:t=>{n.value&&(e.value=t),t?(isRange(t)?null!==t.end&&(e.value=t):e.value=t,l.value=t):e.value=t}});a(e,(e=>{l.value=e}));return{valueComputed:s,reset:()=>{l.value&&isRange(l.value)&&(l.value=e.value&&r(e.value))}}},E=j(L,["mask","returnRaw","autosize","minRows","maxRows","type","inputmode","counter","maxLength"]),N=j(S);var z=n({name:"VaDateInput",components:{VaDropdown:H,VaDropdownContent:K,VaDatePicker:S,VaInput:L,VaIcon:O},props:{...E,...N,...D,clearValue:{type:Date,default:void 0},modelValue:{type:[Date,Array,Object,String,Number]},resetOnClose:{type:Boolean,default:!0},isOpen:{type:Boolean,default:void 0},format:{type:Function},formatDate:{type:Function,default:e=>e.toLocaleDateString()},parse:{type:Function},parseDate:{type:Function},parseValue:{type:Function},delimiter:{type:String,default:", "},rangeDelimiter:{type:String,default:" ~ "},manualInput:{type:Boolean,default:!1},color:{type:String,default:"primary"},leftIcon:{type:Boolean,default:!1},icon:{type:String,default:"calendar_today"}},emits:[...g(S),...C,...b,...x,"update:is-open","update:text"],setup(e,{emit:n,slots:s}){const i=o(),u=o(),{isOpen:p,resetOnClose:c}=r(e),{valueComputed:d}=$(e,n),{syncProp:m}=function useSyncProp(e,a,n,r){if(void 0===r)return{syncProp:t({set(e){n(`update:${a}`,e)},get:()=>e.value})};const l=o(r);return{syncProp:t({set(e){l.value=e,n(`update:${a}`,e)},get:()=>void 0===(null==e?void 0:e.value)?l.value:e.value})}}(p,"is-open",n,!1),v=t((()=>!c.value)),{valueComputed:f,reset:y}=useRangeModelValueGuard(d,v,e.parseValue);a(m,(e=>{e||v.value||y()}));const dateOrNothing=t=>t?e.formatDate(t):"...",{parseDateInputValue:h,isValid:k}=useDateParser(e);a(f,(()=>{k.value=!0}));const modelValueToString=t=>{if(e.format)return e.format(f.value);if(T(t))return t.map((t=>e.formatDate(t))).join(e.delimiter);if(F(t))return e.formatDate(t);if(B(t))return dateOrNothing(t.start)+e.rangeDelimiter+dateOrNothing(t.end);throw new Error("VaDatePicker: Invalid model value. Value should be Date, Date[] or { start: Date, end: Date | null }")},{text:w,value:g}=(C=f,x=h,D=modelValueToString,{text:t({get(){const e=C.value;return"string"==typeof e?e:D(e)},set(e){"string"==typeof C.value?C.value=e:C.value=x(e)}}),value:t({get:()=>"string"==typeof C.value?x(C.value):C.value,set(e){"string"==typeof C.value?C.value=D(e):C.value=e}})});var C,x,D;const b=t((()=>k.value?f.value?w.value:e.clearValue?modelValueToString(e.clearValue):"":"")),reset=()=>{d.value=e.clearValue,n("clear")},focus=()=>{var e;null===(e=i.value)||void 0===e||e.focus()},focusDatePicker=()=>{l((()=>{var e;return null===(e=u.value)||void 0===e?void 0:e.focusCurrentPicker()}))},focusInputOrPicker=()=>{m.value?focusDatePicker():focus()},{computedError:_,computedErrorMessages:H,listeners:K}=I(e,n,reset,focus),L=t((()=>!k.value&&f.value!==e.clearValue||_.value)),O=t((()=>{const t=[e.leftIcon&&"prependInner",(!e.leftIcon||e.clearable)&&"icon"];return Object.keys(s).filter((e=>!t.includes(e)))})),{canBeCleared:U,clearIconProps:W,onFocus:A,onBlur:R}=V(e,f),N=t((()=>({name:e.icon,color:e.color,size:"small",class:"va-date-input__icon"}))),z=t((()=>({...P(e,E).value,clearable:!1,rules:[],error:L.value,errorMessages:H.value,readonly:e.readonly||!e.manualInput}))),M=t((()=>({focus:()=>{A(),K.onFocus()},blur:()=>{R(),K.onBlur()}})));return{datePicker:u,valueText:b,valueWithoutText:g,valueComputed:f,isOpenSync:m,onInputTextChanged:({target:e})=>{const t=h(e.value);k.value&&(f.value=t)},input:i,inputProps:z,inputListeners:M,datePickerProps:P(e,j(S)),filterSlots:O,canBeCleared:U,clearIconProps:W,iconProps:N,hideAndFocus:()=>{m.value=!1,focus()},showAndFocus:t=>{e.manualInput||(m.value=!0,focusDatePicker(),t.preventDefault())},toggleDropdown:()=>{m.value=!m.value,l(focusInputOrPicker)},showDropdown:()=>{m.value=!0,l(focusInputOrPicker)},focusInputOrPicker:focusInputOrPicker,reset:reset,focus:focus,blur:()=>{var e;null===(e=i.value)||void 0===e||e.blur()}}}});z.ssrRender=function ssrRender(e,t,o,a,n,r,l,j){const g=s("va-dropdown"),P=s("va-input"),C=s("va-icon"),V=s("va-dropdown-content"),x=s("va-date-picker");t(`<div${U(i({class:"va-date-input"},a))}>`),t(W(g,{modelValue:e.isOpenSync,"onUpdate:modelValue":t=>e.isOpenSync=t,trigger:"none",anchorSelector:".va-input-wrapper__field",offset:[2,0],"close-on-content-click":!1,stateful:!1,disabled:e.disabled},{anchor:u(((t,o,a,n)=>{if(!o)return[d(e.$slots,"input",{valueText:e.valueText,inputProps:e.inputProps,inputListeners:e.inputListeners},(()=>[w(P,i({ref:"input",class:"va-date-input__input"},e.inputProps,p(e.inputListeners),{"model-value":e.valueText,"aria-label":"selected date",onChange:e.onInputTextChanged,onClick:t=>e.toggleDropdown(),onKeydown:[y(h(e.showAndFocus,["stop"]),["enter"]),y(h(e.showAndFocus,["stop"]),["space"])]}),c({prependInner:u((t=>[d(e.$slots,"prependInner",t),e.$props.leftIcon?(m(),v(C,i({key:0},e.iconProps),null,16)):f("v-if",!0)])),icon:u((()=>[e.canBeCleared?(m(),v(C,i({key:0,"aria-hiden":"false",role:"button","aria-label":"reset",tabindex:"0",class:"va-date-input__clear-icon"},e.clearIconProps,{onClick:t=>e.reset(),onKeydown:[y(h((t=>e.reset()),["stop"]),["enter"]),y(h((t=>e.reset()),["stop"]),["space"])]}),null,16,["onClick","onKeydown"])):e.$props.leftIcon?f("v-if",!0):(m(),v(C,i({key:1},e.iconProps,{tabindex:"0",onKeydown:[y(h(e.showDropdown,["stop"]),["enter"]),y(h(e.showDropdown,["stop"]),["space"])]}),null,16,["onKeydown"]))])),_:2},[k(e.filterSlots,(t=>({name:t,fn:u((o=>[d(e.$slots,t,o)]))})))]),1040,["model-value","onChange","onClick","onKeydown"])]))];A(e.$slots,"input",{valueText:e.valueText,inputProps:e.inputProps,inputListeners:e.inputListeners},(()=>{o(W(P,i({ref:"input",class:"va-date-input__input"},e.inputProps,p(e.inputListeners),{"model-value":e.valueText,"aria-label":"selected date"}),c({prependInner:u(((t,o,a,n)=>{if(!o)return[d(e.$slots,"prependInner",t),e.$props.leftIcon?(m(),v(C,i({key:0},e.iconProps),null,16)):f("v-if",!0)];A(e.$slots,"prependInner",t,null,o,a,n),e.$props.leftIcon?o(W(C,e.iconProps,null,a,n)):o("\x3c!----\x3e")})),icon:u(((t,o,a,n)=>{if(!o)return[e.canBeCleared?(m(),v(C,i({key:0,"aria-hiden":"false",role:"button","aria-label":"reset",tabindex:"0",class:"va-date-input__clear-icon"},e.clearIconProps,{onClick:t=>e.reset(),onKeydown:[y(h((t=>e.reset()),["stop"]),["enter"]),y(h((t=>e.reset()),["stop"]),["space"])]}),null,16,["onClick","onKeydown"])):e.$props.leftIcon?f("v-if",!0):(m(),v(C,i({key:1},e.iconProps,{tabindex:"0",onKeydown:[y(h(e.showDropdown,["stop"]),["enter"]),y(h(e.showDropdown,["stop"]),["space"])]}),null,16,["onKeydown"]))];e.canBeCleared?o(W(C,i({"aria-hiden":"false",role:"button","aria-label":"reset",tabindex:"0",class:"va-date-input__clear-icon"},e.clearIconProps),null,a,n)):e.$props.leftIcon?o("\x3c!----\x3e"):o(W(C,i(e.iconProps,{tabindex:"0"}),null,a,n))})),_:2},[k(e.filterSlots,(t=>({name:t,fn:u(((o,a,n,r)=>{if(!a)return[d(e.$slots,e.name,o)];A(e.$slots,t,o,null,a,n,r)}))})))]),a,n))}),o,a,n)})),default:u(((t,o,a,n)=>{if(!o)return[w(V,{onKeydown:y(h((t=>e.hideAndFocus()),["stop","prevent"]),["esc"])},{default:u((()=>[w(x,i({ref:"datePicker"},e.datePickerProps,{modelValue:e.valueWithoutText,"onUpdate:modelValue":t=>e.valueWithoutText=t,"onClick:day":t=>e.$emit("click:day",t),"onClick:month":t=>e.$emit("click:month",t),"onClick:year":t=>e.$emit("click:year",t),"onHover:day":t=>e.$emit("hover:day",t),"onHover:month":t=>e.$emit("hover:month",t),"onHover:year":t=>e.$emit("hover:year",t),"onUpdate:view":t=>e.$emit("update:view",t)}),c({_:2},[k(e.$slots,((t,o)=>({name:o,fn:u((t=>[d(e.$slots,o,t)]))})))]),1040,["modelValue","onUpdate:modelValue","onClick:day","onClick:month","onClick:year","onHover:day","onHover:month","onHover:year","onUpdate:view"])])),_:3},8,["onKeydown"])];o(W(V,null,{default:u(((t,o,a,n)=>{if(!o)return[w(x,i({ref:"datePicker"},e.datePickerProps,{modelValue:e.valueWithoutText,"onUpdate:modelValue":t=>e.valueWithoutText=t,"onClick:day":t=>e.$emit("click:day",t),"onClick:month":t=>e.$emit("click:month",t),"onClick:year":t=>e.$emit("click:year",t),"onHover:day":t=>e.$emit("hover:day",t),"onHover:month":t=>e.$emit("hover:month",t),"onHover:year":t=>e.$emit("hover:year",t),"onUpdate:view":t=>e.$emit("update:view",t)}),c({_:2},[k(e.$slots,((t,o)=>({name:o,fn:u((t=>[d(e.$slots,o,t)]))})))]),1040,["modelValue","onUpdate:modelValue","onClick:day","onClick:month","onClick:year","onHover:day","onHover:month","onHover:year","onUpdate:view"])];o(W(x,i({ref:"datePicker"},e.datePickerProps,{modelValue:e.valueWithoutText,"onUpdate:modelValue":t=>e.valueWithoutText=t}),c({_:2},[k(e.$slots,((t,o)=>({name:o,fn:u(((t,a,n,r)=>{if(!a)return[d(e.$slots,e.name,t)];A(e.$slots,o,t,null,a,n,r)}))})))]),a,n))})),_:3},a,n))})),_:3},o)),t("</div>")},z.__file="src/components/va-date-input/VaDateInput.vue";const M=e(z);export{M as VaDateInput};
//# sourceMappingURL=index24.js.map
