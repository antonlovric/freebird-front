import{computed as e,getCurrentInstance as t,shallowRef as a,onMounted as r,onUpdated as o,onBeforeUnmount as l,ref as n,watch as u,defineComponent as s,nextTick as i,mergeProps as p,toRefs as d,resolveComponent as c,createSlots as m,withCtx as v,openBlock as g,createBlock as b,withModifiers as f,withKeys as y,createCommentVNode as x,renderSlot as h,renderList as V}from"vue";import{s as w,o as $}from"./VaIcon.js";import{e as _}from"./usePopover.js";import{e as k,f as C}from"./child-props.js";import"./global-config.js";import"./global-utils.js";import{a as I}from"./useFocus.js";import"colortranslator";import{u as P}from"./useEmitProxy.js";import{u as R}from"./useCaptureEvent.js";import{u as S}from"./useForm.js";import{u as B,a as E,b as j}from"./index67.js";import F from"cleave.js";import{s as z}from"./VaInputWrapper.js";import{ssrRenderAttrs as L,ssrInterpolate as A,ssrRenderComponent as H,ssrRenderSlot as M}from"@vue/server-renderer";const N={clearable:{type:Boolean,default:!1},clearableIcon:{type:String,default:"highlight_off"},clearValue:{type:String,default:""}},T=["clear"],useClearable=(t,a,r,o)=>{const{isFocused:l,onFocus:n,onBlur:u}=I(r),s=[null,void 0,t.clearValue],i=e((()=>t.clearable&&!t.disabled&&!t.readonly&&!s.includes(a.value))),p=e((()=>(null==l?void 0:l.value)?t.color||"primary":(null==o?void 0:o.value)?"danger":t.success?"success":"secondary")),d=e((()=>({name:t.clearableIcon,color:p.value,size:"small"})));return{canBeCleared:i,clearIconColor:p,clearIconProps:d,onFocus:n,onBlur:u}},useFocusDeep=n=>{const u=(()=>{const e=a(),updateActiveElement=()=>{e.value=document.activeElement};return r(updateActiveElement),R("focus",updateActiveElement),R("blur",updateActiveElement),e})(),s=(e=>{if(e)return e;const n=t(),u=a();return r((()=>{var e;u.value=null!==(e=n.proxy.$el)&&void 0!==e?e:void 0})),o((()=>{var e;u.value=null!==(e=n.proxy.$el)&&void 0!==e?e:void 0})),l((()=>{var e;u.value=null!==(e=n.proxy.$el)&&void 0!==e?e:void 0})),u})(n);let i=null;return e({get(){var e;if(!u.value)return!1;if(u.value===s.value)return!0;const t=null===(e=s.value)||void 0===e?void 0:e.contains(u.value);return t&&(i=u.value),t},set(e){const t=null!=i?i:s.value;e?null==t||t.focus():null==t||t.blur()}})},q={creditCard:{creditCard:!0},date:{date:!0,datePattern:["d","m","Y"]},time:{time:!0,timePattern:["h","m"],timeFormat:"24"},numeral:{numeral:!0,numeralThousandsGroupStyle:"thousand"}},O={mask:{type:[String,Object],default:""},returnRaw:{type:Boolean,default:!0},modelValue:{type:String}},useCleave=(t,a,o)=>{const s=n(),destroyCleave=()=>{s.value&&s.value.destroy()},initCleave=()=>{var e;(destroyCleave(),t.value)&&(s.value=new F(t.value,"string"==typeof(e=a.mask)?q[e]?{...q[e]}:{}:{...e}))};r((()=>{initCleave()})),l((()=>{destroyCleave()})),u((()=>[t.value,a.mask]),(()=>{initCleave()}));const i=e((()=>s.value&&a.returnRaw&&a.modelValue===s.value.getRawValue()?s.value.getFormattedValue():a.modelValue));return{cleave:s,computedValue:i,onInput:e=>{const t=e.target.value;("string"===a.mask||Object.keys(a.mask).length)&&s.value&&(s.value.setRawValue(t),a.returnRaw)?o("update:modelValue",s.value.getRawValue()):o("update:modelValue",t)}}},W=["letter-spacing","line-height","padding-top","padding-bottom","font-family","font-weight","font-size","text-rendering","text-transform","width","text-indent","padding-left","padding-right","border-width","box-sizing"],getNodeHeightStyles=e=>{const t=window.getComputedStyle(e);return{boxSizing:t.getPropertyValue("box-sizing")||t.getPropertyValue("-moz-box-sizing")||t.getPropertyValue("-webkit-box-sizing"),padding:parseFloat(t.getPropertyValue("padding-bottom"))+parseFloat(t.getPropertyValue("padding-top")),border:parseFloat(t.getPropertyValue("border-bottom-width"))+parseFloat(t.getPropertyValue("border-top-width")),styles:W.map((e=>`${e}:${t.getPropertyValue(e)}`)).join(";")+";",lineHeight:parseInt(t.getPropertyValue("line-height"))}};let K=null;const createHiddenTextarea=(e,t)=>{K||(K=document.createElement("textarea")),K.setAttribute("style",t+"\n  min-height:0 !important;\n  max-height:none !important;\n  height:0 !important;\n  visibility:hidden !important;\n  overflow:hidden !important;\n  position:absolute !important;\n  z-index:-1000 !important;\n  top:0 !important;\n  right:0 !important';\n"),K.value=e.value||e.placeholder||"";const a=e.getAttribute("wrap");return null!==a?K.setAttribute("wrap",a):K.removeAttribute("wrap"),K},positiveNumberValidator=e=>{if(e>0&&(0|e)===e)return!0;throw new Error(`\`minRows|maxRows\` must be a positive integer greater than 0, but ${e} is provided`)},{createEmits:D,createListeners:G}=P(["input","change","click","update:modelValue"]);var Y=s({name:"VaTextarea",props:{...S,modelValue:{type:[String,Number],default:""},placeholder:{type:String},autosize:{type:Boolean,default:!1},minRows:{type:Number,default:1,validator:positiveNumberValidator},maxRows:{type:Number,validator:positiveNumberValidator}},emits:D(),setup(t,{emit:o}){const l=a(),s=n(-1),p=n(-1),{calculateRowHeight:d,calculateHeight:c}=(e=>({calculateRowHeight:()=>e.value?getNodeHeightStyles(e.value).lineHeight:0,calculateHeight:()=>{if(!e.value)return 0;const{boxSizing:t,padding:a,border:r,styles:o}=getNodeHeightStyles(e.value),l=createHiddenTextarea(e.value,o);document.body.appendChild(l);let n=l.scrollHeight;return"border-box"===t?n+=r:"content-box"===t&&(n-=a),document.body.removeChild(l),n}}))(l),m=e((()=>Boolean((t.autosize||t.maxRows||1!==t.minRows)&&l.value))),updateHeight=()=>{m.value&&(p.value=c())};r((()=>{m.value&&(s.value=d()),updateHeight()})),u((()=>t.modelValue),(()=>{i(updateHeight)}));const v=e((()=>({minHeight:s.value*t.minRows+"px",maxHeight:t.maxRows?s.value*t.maxRows+"px":void 0,height:p.value+"px",resize:m.value?void 0:"none"}))),g=e((()=>({..._(t,["disabled","readonly","placeholder","ariaLabel"])})));return{textarea:l,computedStyle:v,listeners:G(o),computedProps:g,focus:()=>{var e;null===(e=l.value)||void 0===e||e.focus()},blur:()=>{var e;null===(e=l.value)||void 0===e||e.blur()}}}});Y.ssrRender=function ssrRender$1(e,t,a,r,o,l,n,u){let s;t(`<textarea${L(s=p({ref:"textarea",class:"textarea",style:e.computedStyle},{...e.computedProps,...e.listeners},{value:e.modelValue},r),"textarea")}>${A("value"in s?s.value:"")}</textarea>`)},Y.__file="src/components/va-input/components/VaTextarea/VaTextarea.vue";const J=k(Y),{createEmits:Q,createListeners:U}=P(["change","keyup","keypress","keydown","focus","blur"]),{createEmits:X,createListeners:Z}=P(["click","click-prepend","click-append","click-prepend-inner","click-append-inner"]);var ee=s({name:"VaInput",components:{VaInputWrapper:z,VaTextarea:Y,VaIcon:w},props:{...S,...B,...N,...O,...J,placeholder:{type:String,default:""},tabindex:{type:Number,default:0},modelValue:{type:[String,Number],default:""},label:{type:String,default:""},type:{type:String,default:"text"},loading:{type:Boolean,default:!1},inputClass:{type:String,default:""},pattern:{type:String},inputmode:{type:String,default:"text"},ariaLabel:{type:String,default:void 0},counter:{type:Boolean,default:!1},maxLength:{type:Number,default:void 0},color:{type:String,default:"primary"},outline:{type:Boolean,default:!1},bordered:{type:Boolean,default:!1},requiredMark:{type:Boolean,default:!1}},emits:["update:modelValue",...E,...T,...Q(),...X()],inheritAttrs:!1,setup(t,{emit:r,attrs:o,slots:l}){const n=a(),u=useFocusDeep(),reset=()=>{r("update:modelValue",t.clearValue),r("clear")},focus=()=>{var e;null===(e=n.value)||void 0===e||e.focus()},s=e((()=>{const e=["icon"];return Object.keys(l).filter((t=>!e.includes(t)))})),{computedError:i,computedErrorMessages:p,listeners:c}=j(t,r,reset,focus),{modelValue:m}=d(t),{canBeCleared:v,clearIconProps:g}=useClearable(t,m,n,i),b=e((()=>"textarea"===t.type?void 0:n.value)),{computedValue:f,onInput:y}=useCleave(b,t,r),x=U(r),h={...x,onFocus:e=>{x.onFocus(e),c.onFocus()},onBlur:e=>{x.onBlur(e),c.onBlur()},onInput:y},V=e((()=>t.disabled?-1:t.tabindex)),w=e((()=>({ariaLabel:t.ariaLabel||t.label,ariaRequired:t.requiredMark,ariaDisabled:t.disabled,ariaReadOnly:t.readonly,"aria-invalid":!!p.value.length,"aria-errormessage":"string"==typeof p.value?p.value:p.value.join(", "),tabindex:V.value,class:t.inputClass,...$(o,["class","style"])}))),k=e((()=>({...w.value,..._(t,["type","disabled","readonly","placeholder","pattern","inputmode"])}))),I=e((()=>t.counter&&"string"==typeof f.value?f.value.length:void 0));return{input:n,inputEvents:h,valueLengthComputed:I,computedChildAttributes:w,computedInputAttributes:k,textareaProps:C(t,J),computedValue:f,tabIndexComputed:V,computedError:i,computedErrorMessages:p,isFocused:u,canBeCleared:v,clearIconProps:g,fieldListeners:Z(r),filterSlots:s,reset:reset,focus:focus,blur:()=>{var e;null===(e=n.value)||void 0===e||e.blur()}}}});ee.ssrRender=function ssrRender(e,t,a,r,o,l,n,u){const s=c("VaInputWrapper"),i=c("va-icon"),d=c("VaTextarea");t(H(s,p(e.fieldListeners,{class:e.$attrs.class,style:e.$attrs.style,color:e.$props.color,readonly:e.$props.readonly,disabled:e.$props.disabled,success:e.$props.success,messages:e.$props.messages,error:e.computedError,"error-messages":e.computedErrorMessages,"error-count":e.errorCount,label:e.$props.label,bordered:e.$props.bordered,outline:e.$props.outline,requiredMark:e.$props.requiredMark,focused:e.isFocused,"counter-value":e.valueLengthComputed,"max-length":e.$props.maxLength},r),m({icon:v(((t,a,r,o)=>{if(!a)return[e.canBeCleared?(g(),b(i,p({key:0,role:"button","aria-hidden":"false","aria-label":"reset",class:"va-input__icons__reset",tabindex:e.tabIndexComputed},e.clearIconProps,{onClick:f(e.reset,["stop"]),onKeydown:[y(f(e.reset,["stop"]),["enter"]),y(f(e.reset,["stop"]),["space"])]}),null,16,["tabindex","onClick","onKeydown"])):x("v-if",!0),e.$props.loading?(g(),b(i,{key:1,color:e.$props.color,size:"small",name:"loop",spin:"counter-clockwise"},null,8,["color"])):x("v-if",!0),h(e.$slots,"icon",t)];e.canBeCleared?a(H(i,p({role:"button","aria-hidden":"false","aria-label":"reset",class:"va-input__icons__reset",tabindex:e.tabIndexComputed},e.clearIconProps),null,r,o)):a("\x3c!----\x3e"),e.$props.loading?a(H(i,{color:e.$props.color,size:"small",name:"loop",spin:"counter-clockwise"},null,r,o)):a("\x3c!----\x3e"),M(e.$slots,"icon",t,null,a,r,o)})),default:v(((t,a,r,o)=>{if(!a)return["textarea"!==e.type||e.$slots.content?e.$slots.content?x("v-if",!0):(g(),b("input",p({key:1,ref:"input",class:"va-input__content__input"},{...e.computedInputAttributes,...e.inputEvents},{value:e.computedValue}),null,16,["value"])):(g(),b(d,p({key:0,ref:"input"},{...e.computedChildAttributes,...e.textareaProps,...e.inputEvents},{class:"va-input__content__input"}),null,16))];"textarea"!==e.type||e.$slots.content?e.$slots.content?a("\x3c!----\x3e"):a(`<input${L(p({ref:"input",class:"va-input__content__input"},{...e.computedInputAttributes,...e.inputEvents},{value:e.computedValue}))}${o}>`):a(H(d,p({ref:"input"},{...e.computedChildAttributes,...e.textareaProps,...e.inputEvents},{class:"va-input__content__input"}),null,r,o))})),_:2},[V(e.filterSlots,(t=>({name:t,fn:v(((a,r,o,l)=>{if(!r)return[h(e.$slots,e.name,a)];M(e.$slots,t,a,null,r,o,l)}))})))]),a))},ee.__file="src/components/va-input/VaInput.vue";export{useClearable as a,N as b,useFocusDeep as c,ee as s,T as u};
//# sourceMappingURL=VaInput.js.map
