import{w as e}from"./withConfigTransport.js";import{defineComponent as l,resolveComponent as o,mergeProps as a,withCtx as i,createTextVNode as t,ref as n,openBlock as r,createBlock as s,createVNode as d,toDisplayString as u,withKeys as p,withModifiers as m,computed as f,onMounted as v,watch as c,shallowRef as g}from"vue";import"./global-config.js";import"./usePopover.js";import"./global-utils.js";import{e as y,u as _}from"./useColors.js";import{VaButton as F}from"./index12.js";import{VaCard as V}from"./index13.js";import{VaIcon as b}from"./index31.js";import{ssrRenderAttrs as x,ssrRenderComponent as U,ssrInterpolate as $,ssrRenderAttr as j,ssrRenderStyle as B,ssrRenderList as S,ssrRenderSlot as h,ssrIncludeBooleanAttr as I}from"@vue/server-renderer";import{V as L}from"./VaModal.js";import"./VaConfig.js";import"./global-properties.js";import"./isSymbol.js";import"./ssr-utils.js";import"colortranslator";import"./VaButton.js";import"./useLoading.js";import"./useRouterLink.js";import"./useSize.js";import"./useTextColor.js";import"./index43.js";import"./clamp.js";import"./toNumber.js";import"./VaIcon.js";import"./useAlign.js";import"./useStateful.js";var D=l({name:"VaFileUploadUndo",components:{VaButton:F},emits:["recover"]});D.ssrRender=function ssrRender$5(e,l,n,r,s,d,u,p){const m=o("va-button");l(`<div${x(a({class:"va-file-upload-undo"},r))}><span>File was successfully deleted</span>`),l(U(m,{class:"va-file-upload-undo__button",size:"small",outline:""},{default:i(((e,l,o,a)=>{if(!l)return[t(" Undo ")];l(" Undo ")})),_:1},n)),l("</div>")},D.__file="src/components/va-file-upload/VaFileUploadUndo/VaFileUploadUndo.vue";const R=e(D);var z=l({name:"VaFileUploadListItem",components:{VaIcon:b,VaCard:V,VaFileUploadUndo:R},emits:["remove"],props:{file:{type:Object,default:null},color:{type:String,default:"success"},undo:{type:Boolean,default:!1},undoDuration:{type:Number,default:3e3}},setup(e,{emit:l}){const o=n(!1);return{removed:o,removeFile:()=>{e.undo?(o.value=!0,setTimeout((()=>{o.value&&(l("remove"),o.value=!1)}),e.undoDuration)):(l("remove"),o.value=!1)},recoverFile:()=>{o.value=!1}}}});z.ssrRender=function ssrRender$4(e,l,t,n,f,v,c,g){const y=o("va-card"),_=o("va-file-upload-undo"),F=o("va-icon");l(U(y,a({class:["va-file-upload-list-item",{"file-upload-list-item--undo":e.removed}],stripe:e.removed&&e.undo,stripeColor:e.color,"no-margin":"","no-padding":""},n),{default:i(((l,o,a,i)=>{if(!o)return[e.removed&&e.undo?(r(),s(_,{key:0,onRecover:e.recoverFile},null,8,["onRecover"])):(r(),s("div",{key:1,class:"va-file-upload-list-item__content"},[d("div",{class:"va-file-upload-list-item__name"},u(e.file&&e.file.name),1),d("div",{class:"va-file-upload-list-item__size"},u(e.file&&e.file.size),1),d(F,{class:"va-file-upload-list-item__delete",name:"clear",role:"button","aria-hidden":"false","aria-label":"remove file",tabindex:"0",color:"danger",onClick:e.removeFile,onKeydown:[p(m(e.removeFile,["stop"]),["enter"]),p(m(e.removeFile,["stop"]),["space"])]},null,8,["onClick","onKeydown"])]))];e.removed&&e.undo?o(U(_,null,null,a,i)):(o(`<div class="va-file-upload-list-item__content"${i}><div class="va-file-upload-list-item__name"${i}>${$(e.file&&e.file.name)}</div><div class="va-file-upload-list-item__size"${i}>${$(e.file&&e.file.size)}</div>`),o(U(F,{class:"va-file-upload-list-item__delete",name:"clear",role:"button","aria-hidden":"false","aria-label":"remove file",tabindex:"0",color:"danger"},null,a,i)),o("</div>"))})),_:1},t))},z.__file="src/components/va-file-upload/VaFileUploadListItem/VaFileUploadListItem.vue";const C=e(z);var T=l({name:"VaFileUploadGalleryItem",components:{VaFileUploadUndo:R,VaButton:F},emits:["remove"],props:{file:{type:Object,default:null},color:{type:String,default:"success"},undo:{type:Boolean,default:!1},undoDuration:{type:Number,default:3e3}},setup(e,{emit:l}){const o=n(""),a=n(!1),i=n(!1),t=f((()=>({backgroundColor:y(e.color,.7)}))),convertToImg=()=>{if(e.file.name&&e.file.image)if(e.file.image.url)o.value=e.file.image.url;else if(e.file.image instanceof File){const l=new FileReader;l.readAsDataURL(e.file.image),l.onload=e=>{var l,a;(null===(l=e.target)||void 0===l?void 0:l.result).includes("image")&&(o.value=null===(a=e.target)||void 0===a?void 0:a.result)}}};return v(convertToImg),c((()=>e.file),convertToImg),{previewImage:o,removed:a,isFocused:i,recoverImage:()=>{a.value=!1},overlayStyles:t,removeImage:()=>{e.undo?(a.value=!0,setTimeout((()=>{a.value&&(l("remove"),a.value=!1)}),e.undoDuration)):(l("remove"),a.value=!1)}}}});T.ssrRender=function ssrRender$3(e,l,i,t,n,r,s,d){const u=o("va-file-upload-undo"),p=o("va-button");e.removed&&e.undo?(l(`<div${x(a({class:["va-file-upload-gallery-item",{"va-file-upload-gallery-item--undo":e.removed}]},t))}>`),l(U(u,{class:"va-file-upload-gallery-item--undo"},null,i)),l("</div>")):(l(`<div${x(a({tabindex:"0",class:["va-file-upload-gallery-item",{"file-upload-gallery-item_not-image":!e.previewImage,"va-file-upload-gallery-item--focused":e.isFocused}]},t))}>`),e.previewImage?l(`<img${j("src",e.previewImage)} alt="" class="va-file-upload-gallery-item__image">`):l("\x3c!----\x3e"),l(`<div class="va-file-upload-gallery-item__overlay"><div class="va-file-upload-gallery-item__overlay-background" style="${B(e.overlayStyles)}"></div><div class="va-file-upload-gallery-item__name"${j("title",e.file.name)}>${$(e.file.name)}</div>`),l(U(p,{flat:"",color:"danger",icon:"delete_outline",class:"va-file-upload-gallery-item__delete","aria-label":"remove image"},null,i)),l("</div></div>"))},T.__file="src/components/va-file-upload/VaFileUploadGalleryItem/VaFileUploadGalleryItem.vue";const w=e(T);var k=l({name:"VaFileUploadSingleItem",components:{VaButton:F},emits:["remove"],props:{file:{type:Object,default:null}}});k.ssrRender=function ssrRender$2(e,l,n,r,s,d,u,p){const m=o("va-button");l(`<div${x(a({class:"va-file-upload-single-item"},r))}><div class="va-file-upload-single-item__name">${$(e.file&&e.file.name)}</div>`),l(U(m,{class:"va-file-upload-single-item__button",size:"small",color:"danger",flat:""},{default:i(((e,l,o,a)=>{if(!l)return[t(" Delete ")];l(" Delete ")})),_:1},n)),l("</div>")},k.__file="src/components/va-file-upload/VaFileUploadSingleItem/VaFileUploadSingleItem.vue";const A=e(k);var M=l({name:"VaFileUploadList",components:{VaFileUploadListItem:C,VaFileUploadGalleryItem:w,VaFileUploadSingleItem:A},emits:["remove","removeSingle"],props:{type:{type:String,default:""},files:{type:Array,default:null},color:{type:String,default:"success"},undo:{type:Boolean,default:!1},undoDuration:{type:Number,default:3e3}},setup(e){const l=f((()=>e.files.map(convertFile))),convertFile=e=>({name:e.name||e.url||"",size:formatSize(e.size),date:formatDate(new Date),image:e}),formatSize=e=>{if(0===e)return"0 Bytes";if(!e)return"";const l=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,l)).toFixed(2))+" "+["Bytes","KB","MB","GB","TB","PB","EB","ZB","YB"][l]},formatDate=(e=new Date)=>e.toLocaleDateString("en-US",{hour:"2-digit",minute:"2-digit",month:"short",day:"numeric",year:"numeric"});return{filesList:l}}});M.ssrRender=function ssrRender$1(e,l,i,t,n,r,s,d){const u=o("va-file-upload-list-item"),p=o("va-file-upload-gallery-item"),m=o("va-file-upload-single-item");l(`<div${x(a({class:["va-file-upload-list",`va-file-upload-list--${e.type}`],role:"single"!==e.type?"list":void 0},t))}>`),"list"===e.type?(l("\x3c!--[--\x3e"),S(e.filesList,((o,a)=>{l(U(u,{key:o.name,role:"listitem",file:o,color:e.color,undo:e.undo,undoDuration:e.undoDuration},null,i))})),l("\x3c!--]--\x3e")):l("\x3c!----\x3e"),"gallery"===e.type?(l("\x3c!--[--\x3e"),S(e.filesList,((o,a)=>{l(U(p,{role:"listitem",file:o,key:o.name,color:e.color,undo:e.undo,undoDuration:e.undoDuration},null,i))})),l("\x3c!--]--\x3e")):l("\x3c!----\x3e"),"single"===e.type&&e.filesList.length?l(U(m,{file:e.filesList[e.filesList.length-1]},null,i)):l("\x3c!----\x3e"),l("</div>")},M.__file="src/components/va-file-upload/VaFileUploadList/VaFileUploadList.vue";const G=e(M);var N=l({name:"VaFileUpload",components:{VaModal:L,VaButton:F,VaFileUploadList:G},props:{fileTypes:{type:String,default:""},dropzone:{type:Boolean,default:!1},hideFileList:{type:Boolean,default:!1},color:{type:String,default:"primary"},disabled:{type:Boolean,default:!1},undo:{type:Boolean,default:!1},undoDuration:{type:Number,default:3e3},dropZoneText:{type:String,default:"Drag’n’drop files or"},uploadButtonText:{type:String,default:"Upload file"},modelValue:{type:[Object,Array],default:()=>[]},type:{type:String,default:"list",validator:e=>["list","gallery","single"].includes(e)}},emits:["update:modelValue","file-removed","file-added"],setup(e,{emit:l}){const o=g(),a=n(!1),i=n(!1),{getColor:t,shiftHSLAColor:r}=_(),s=f((()=>t(e.color))),d=f((()=>({backgroundColor:e.dropzone?r(s.value,{a:i.value?-.82:-.92}):"transparent"}))),u=f({get:()=>Array.isArray(e.modelValue)?e.modelValue:[e.modelValue],set(o){"single"===e.type?l("update:modelValue",o[0]):l("update:modelValue",o)}}),validateFiles=l=>l.filter((l=>{const o=l.name||l.url;if(!o)return!1;if(l.url)return!0;if(["audio/*","video/*","image/*"].find((l=>e.fileTypes.includes(l))))return!0;const i=o.substring(o.lastIndexOf(".")+1).toLowerCase(),t=e.fileTypes.includes(i);return t||(a.value=!0),t})),uploadFile=o=>{var a,i;const t=(null===(a=o.target)||void 0===a?void 0:a.files)||(null===(i=o.dataTransfer)||void 0===i?void 0:i.files);if(!t)return;const n=e.fileTypes?validateFiles(Array.from(t)):t;u.value="single"===e.type?n:[...u.value,...n],l("file-added",n)};return v((()=>{Array.isArray(u.value)&&(u.value=validateFiles(u.value))})),{modal:a,dropzoneHighlight:i,fileInputRef:o,colorComputed:s,computedStyle:d,uploadFile:uploadFile,changeFieldValue:e=>{uploadFile(e),o.value&&(o.value.value="")},files:u,removeFile:e=>{if(e in u.value){const o=u.value[e];u.value=u.value.filter(((l,o)=>o!==e)),l("file-removed",o)}},removeSingleFile:()=>{if(u.value.length>0){const e=u.value[0];u.value=[],l("file-removed",e)}},callFileDialogue:()=>{o.value&&o.value.click()}}}});N.ssrRender=function ssrRender(e,l,n,r,s,d,p,m){const f=o("va-button"),v=o("va-file-upload-list"),c=o("va-modal");l(`<div${x(a({class:["va-file-upload",{"va-file-upload--dropzone":e.dropzone}],style:e.computedStyle},r))}>`),h(e.$slots,"default",{},(()=>{l('<div class="va-file-upload__field">'),e.dropzone?l(`<div class="va-file-upload__field__text">${$(e.dropZoneText)}</div>`):l("\x3c!----\x3e"),l(U(f,{class:"va-file-upload__field__button",disabled:e.disabled,color:e.colorComputed,style:{"pointer-events":e.dropzoneHighlight?"none":""}},{default:i(((l,o,a,i)=>{if(!o)return[t(u(e.uploadButtonText),1)];o(`${$(e.uploadButtonText)}`)})),_:1},n)),l("</div>")}),l,n),l(`<input type="file" class="va-file-upload__field__input"${j("tabindex",-1)} aria-hidden="true"${j("accept",e.fileTypes)}${I("single"!==e.type)?" multiple":""}${I(e.disabled)?" disabled":""}>`),e.files.length&&!e.$props.hideFileList?l(U(v,{type:e.type,files:e.files,color:e.colorComputed,undo:e.undo,undoDuration:e.undoDuration},null,n)):l("\x3c!----\x3e"),l(U(c,{modelValue:e.modal,"onUpdate:modelValue":l=>e.modal=l,"hide-default-actions":"",title:"File validation",message:"File type is incorrect!"},null,n)),l("</div>")},N.__file="src/components/va-file-upload/VaFileUpload.vue";const O=e(N);export{O as VaFileUpload,w as VaFileUploadGalleryItem,G as VaFileUploadList,C as VaFileUploadListItem,A as VaFileUploadSingleItem,R as VaFileUploadUndo};
//# sourceMappingURL=index28.js.map
