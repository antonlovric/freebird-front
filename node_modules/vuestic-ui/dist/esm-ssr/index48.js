import{w as e}from"./withConfigTransport.js";import{defineComponent as a,shallowRef as l,ref as r,computed as t,onMounted as o,onBeforeUnmount as i,watch as s,resolveComponent as n,mergeProps as u}from"vue";import{e as v}from"./usePopover.js";import{w as d,g as c}from"./utils.js";import{u as m}from"./useArrayRefs.js";import{u as p}from"./useBem.js";import{u as y}from"./useColors.js";import"./global-config.js";import{VaIcon as f}from"./index31.js";import{ssrRenderAttrs as b,ssrRenderSlot as A,ssrRenderAttr as g,ssrRenderStyle as h,ssrInterpolate as x,ssrRenderComponent as k,ssrRenderList as _,ssrRenderClass as $}from"@vue/server-renderer";import"./VaConfig.js";import"./isSymbol.js";import"./ssr-utils.js";import"./global-utils.js";import"./_createCompounder.js";import"colortranslator";import"./global-properties.js";import"./VaIcon.js";import"./useSize.js";const validateSlider=(e,a,l,r,t)=>{(Array.isArray(e)&&!t||!Array.isArray(e)&&t)&&d(`The type "${Array.isArray(e)?"array":typeof e}" of prop "model-value" does not match prop "range = ${t}".`),r<l&&d("The maximum value can not be less than the minimum value."),l>r&&d("The minimum value can not be greater than the maximum value."),(r-l)%a!=0&&d("Step is illegal. Slider is nondivisible.");const inRange=e=>{e<l?d(`The value of the slider is ${e}, the minimum value is ${l}, the value of this slider can not be less than the minimum value`):e>r&&d(`The value of the slider is ${e}, the maximum value is ${r}, the value of this slider can not be greater than the maximum value`)};return Array.isArray(e)?e.map(inRange):inRange(e),!0};var C=a({name:"VaSlider",components:{VaIcon:f},emits:["drag-start","drag-end","change","update:modelValue"],props:{range:{type:Boolean,default:!1},modelValue:{type:[Number,Array],default:0},trackLabel:{type:[Function,String]},color:{type:String,default:"primary"},trackColor:{type:String,default:""},labelColor:{type:String,default:""},trackLabelVisible:{type:Boolean,default:!1},min:{type:Number,default:0},max:{type:Number,default:100},step:{type:Number,default:1},label:{type:String,default:""},invertLabel:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},readonly:{type:Boolean,default:!1},pins:{type:Boolean,default:!1},iconPrepend:{type:String,default:""},iconAppend:{type:String,default:""},vertical:{type:Boolean,default:!1},showTrack:{type:Boolean,default:!0}},setup(e,{emit:a}){const{getColor:n,getHoverColor:u}=y(),d=l(),f=l(),{setItemRefByIndex:b,itemRefs:A}=m(),g=r(!1),h=r(!1),x=r(0),k=r(0),_=r(e.modelValue),$=r(0),C=r(!1),L=t((()=>e.vertical?[1,0]:[0,1])),V=t((()=>e.vertical?"bottom":"left")),w=t((()=>e.vertical?"height":"width")),S=t((()=>Array.isArray(I.value)&&I.value[1]-e.step<I.value[0])),B=t((()=>Array.isArray(I.value)&&I.value[0]+e.step>I.value[1])),E=p("va-slider",(()=>({...v(e,["disabled","readonly","vertical"]),active:g.value,horizontal:!e.vertical,grabbing:C.value}))),j=p("va-slider__handler",(()=>({onFocus:!e.range&&(h.value||g.value),inactive:!g.value}))),D=t((()=>({color:e.labelColor?n(e.labelColor):n(e.color)}))),R=t((()=>({backgroundColor:e.trackColor?n(e.trackColor):u(n(e.color))}))),T=t((()=>{const a=limitValue(e.modelValue);if(Array.isArray(a)){const l=(a[0]-e.min)/(e.max-e.min)*100,r=(a[1]-e.min)/(e.max-e.min)*100;return{[V.value]:`${l}%`,[w.value]:r-l+"%",backgroundColor:n(e.color),visibility:e.showTrack?"visible":"hidden"}}{const l=(a-e.min)/(e.max-e.min)*100;return{[w.value]:`${l}%`,backgroundColor:n(e.color),visibility:e.showTrack?"visible":"hidden"}}})),P=t((()=>{const a=limitValue(e.modelValue);if(Array.isArray(a)){const l=(a[0]-e.min)/(e.max-e.min)*100,r=(a[1]-e.min)/(e.max-e.min)*100;return[{[V.value]:`${l}%`,backgroundColor:isActiveDot(0)?n(e.color):"#ffffff",borderColor:n(e.color)},{[V.value]:`${r}%`,backgroundColor:isActiveDot(1)?n(e.color):"#ffffff",borderColor:n(e.color)}]}{const l=(a-e.min)/(e.max-e.min)*100;return{[V.value]:`${l}%`,backgroundColor:isActiveDot(0)?n(e.color):"#ffffff",borderColor:n(e.color)}}})),I=t({get:()=>e.modelValue,set:l=>{e.range||(l=limitValue(l)),h.value||a("change",l),a("update:modelValue",l)}}),O=t((()=>{const a=(e.max-e.min)/e.step;return k.value/a})),N=t((()=>{const a=`${e.step}`.split(".")[1];return a?Math.pow(10,a.length):1})),z=t((()=>(e.max-e.min)/e.step-1)),F=t((()=>Array.isArray(e.modelValue)?[(e.modelValue[0]-e.min)/e.step*O.value,(e.modelValue[1]-e.min)/e.step*O.value]:(e.modelValue-e.min)/e.step*O.value)),M=t((()=>[0,k.value])),U=t((()=>[e.min,e.max])),isActiveDot=a=>!(!g.value&&!h.value||e.disabled||e.readonly)&&(e.range?$.value===a:0===$.value),moving=a=>{C.value&&h.value&&!e.disabled&&!e.readonly&&(a.preventDefault(),setValueOnPos(getPos("touches"in a?a.touches[0]:a)))},moveEnd=()=>{if(!e.disabled&&!e.readonly){if(!h.value)return!1;a("drag-end"),a("change",e.modelValue),h.value=!1,C.value=!1}},moveWithKeys=a=>{var l,r;if(![A.value[0],A.value[1],f.value].includes(document.activeElement))return;if(e.disabled||e.readonly)return;const moveDot=(a,l,r)=>{if(a&&Array.isArray(I.value)){if(!e.pins)return I.value.splice(r,1,I.value[r]+(l?e.step:-e.step));const a=(e.max-e.min)/(z.value+1);let t=(I.value[r]/a|0)*a;I.value[r]!==t?(t+=l?a:0,I.value.splice(r,1,t)):I.value.splice(r,1,I.value[r]+(l?e.step:-e.step))}else{if(!e.pins&&!Array.isArray(I.value))return void(I.value+=l?e.step:-e.step);const a=(e.max-e.min)/(z.value+1);let r=(Array.isArray(I.value)?0:I.value/a|0)*a;I.value!==r?(r+=l?a:0,I.value=r):I.value+=l?e.step:-e.step}};["ArrowLeft","ArrowUp","ArrowRight","ArrowDown"].includes(a.key)&&a.preventDefault();const isActive=e=>e===document.activeElement;if(e.range&&Array.isArray(I.value)){const isVerticalDot0More=a=>e.vertical&&isActive(A.value[0])&&"ArrowUp"===a.key,isVerticalDot0Less=a=>e.vertical&&isActive(A.value[0])&&"ArrowDown"===a.key,isVerticalDot1More=a=>e.vertical&&isActive(A.value[1])&&"ArrowUp"===a.key,isVerticalDot1Less=a=>e.vertical&&isActive(A.value[1])&&"ArrowDown"===a.key,isHorizontalDot0Less=a=>!e.vertical&&isActive(A.value[0])&&"ArrowLeft"===a.key,isHorizontalDot0More=a=>!e.vertical&&isActive(A.value[0])&&"ArrowRight"===a.key,isHorizontalDot1Less=a=>!e.vertical&&isActive(A.value[1])&&"ArrowLeft"===a.key,isHorizontalDot1More=a=>!e.vertical&&isActive(A.value[1])&&"ArrowRight"===a.key;switch(!0){case(isVerticalDot1Less(a)||isHorizontalDot1Less(a))&&S.value&&I.value[0]!==e.min:null===(l=A.value[0])||void 0===l||l.focus(),moveDot(!0,0,0);break;case(isVerticalDot0More(a)||isHorizontalDot0More(a))&&B.value&&I.value[1]!==e.max:null===(r=A.value[1])||void 0===r||r.focus(),moveDot(!0,1,1);break;case(isVerticalDot0Less(a)||isHorizontalDot0Less(a))&&I.value[0]!==e.min:moveDot(!0,0,0);break;case(isVerticalDot1More(a)||isHorizontalDot1More(a))&&I.value[1]!==e.max:moveDot(!0,1,1);break;case(isVerticalDot1Less(a)||isHorizontalDot1Less(a))&&I.value[1]!==e.min:moveDot(!0,0,1);break;case(isVerticalDot0More(a)||isHorizontalDot0More(a))&&I.value[0]!==e.max:moveDot(!0,1,0)}}else e.vertical?("ArrowDown"===a.key&&moveDot(!1,0,0),"ArrowUp"===a.key&&moveDot(!1,1,0)):("ArrowLeft"===a.key&&moveDot(!1,0,0),"ArrowRight"===a.key&&moveDot(!1,1,0))},checkActivePin=a=>Array.isArray(I.value)?a*e.step>I.value[0]&&a*e.step<I.value[1]:a*e.step<I.value,H=t((()=>e.step/(e.max-e.min)*100)),getPos=a=>(getStaticData(),e.vertical?x.value-a.clientY:a.clientX-x.value),getStaticData=()=>{d.value&&(k.value=d.value[e.vertical?"offsetHeight":"offsetWidth"],x.value=d.value.getBoundingClientRect()[V.value])},getValueByIndex=a=>(e.step*N.value*a+e.min*N.value)/N.value,setCurrentValue=a=>{const l=$.value;if(Array.isArray(I.value)&&Array.isArray(_.value)&&Array.isArray(e.modelValue))isDiff(_.value[l],a)&&(_.value.splice(l,1,a),0===l?(I.value=[_.value.splice(l,1,a)[0],e.modelValue[1]],_.value=[...I.value]):(I.value=[e.modelValue[0],_.value.splice(l,1,a)[0]],_.value=[...I.value]));else{if(a<e.min||a>e.max)return!1;isDiff(_.value,a)&&(_.value=a,I.value=a)}},setValueOnPos=a=>{const l=M.value,r=U.value,t=Array.isArray(e.modelValue)?A.value[$.value]:f.value;if(null==t||t.focus(),a>=l[0]&&a<=l[1])if($.value){Array.isArray(F.value)&&Array.isArray(I.value)&&a<=F.value[0]&&(I.value[1]=I.value[0],$.value=0);const e=getValueByIndex(Math.round(a/O.value));setCurrentValue(e)}else{Array.isArray(F.value)&&Array.isArray(I.value)&&a>=F.value[1]&&(I.value[0]=I.value[1],$.value=1);const e=getValueByIndex(Math.round(a/O.value));setCurrentValue(e)}else a<l[0]?setCurrentValue(r[0]):setCurrentValue(r[1])},limitValue=a=>{const inRange=a=>a<e.min?e.min:a>e.max?e.max:a;if(Array.isArray(a)){if(a[0]>=a[1]&&0===$.value){const e=inRange(a[1]);return[e,e]}if(a[0]>=a[1]&&1===$.value){const e=inRange(a[0]);return[e,e]}return a.map((e=>inRange(e)))}return inRange(a)},isDiff=(e,a)=>JSON.stringify(e)!==JSON.stringify(a),J=t((()=>`aria-label-id-${c()}`)),W=t((()=>({role:"slider",ariaValuemin:e.min,ariaValuemax:e.max,ariaLabelledby:J.value,ariaOrientation:e.vertical?"vertical":"horizontal",ariaDisabled:e.disabled,ariaReadonly:e.readonly,ariaValuenow:Array.isArray(e.modelValue)?void 0:e.modelValue})));return o((()=>{validateSlider(e.modelValue,e.step,e.min,e.max,e.range)&&(getStaticData(),document.addEventListener("mousemove",moving),document.addEventListener("touchmove",moving,{passive:!1}),document.addEventListener("mouseup",moveEnd),document.addEventListener("mouseleave",moveEnd),document.addEventListener("touchcancel",moveEnd),document.addEventListener("touchend",moveEnd),document.addEventListener("keydown",moveWithKeys))})),i((()=>{document.removeEventListener("mousemove",moving),document.removeEventListener("touchmove",moving),document.removeEventListener("mouseup",moveEnd),document.removeEventListener("mouseleave",moveEnd),document.removeEventListener("touchcancel",moveEnd),document.removeEventListener("touchend",moveEnd),document.removeEventListener("keydown",moveWithKeys)})),s([I,()=>e.step,()=>e.min,()=>e.max,()=>e.range],(([e,a,l,r,t])=>{validateSlider(e,a,l,r,t)})),s(C,(e=>{document.documentElement.style.cursor=e?"grabbing":""})),{getColor:n,dot:f,dots:A,setItemRefByIndex:b,orders:L,sliderContainer:d,val:I,getValueByOrder:a=>e.range&&void 0!==a?I.value[a]:I.value,sliderClass:E,dotClass:j,labelStyles:D,processedStyles:T,getPinStyles:a=>({backgroundColor:checkActivePin(a)?n(e.color):u(n(e.color)),[V.value]:a*H.value+"%",transition:C.value?"none":"var(--va-slider-pin-transition)"}),dottedStyles:P,getDottedStyles:a=>e.range&&void 0!==a?P.value[a]:P.value,clickOnContainer:l=>{if(e.disabled||e.readonly)return;const r=getPos("touches"in l?l.touches[0]:l);Array.isArray(F.value)&&($.value=r>(F.value[1]-F.value[0])/2+F.value[0]?1:0),C.value=!0,setValueOnPos(r),((l,r=$.value)=>{var t,o;if(l.preventDefault(),!r)if(e.range){if(Array.isArray(F.value)){const e="touches"in l?l.touches[0]:l;r=getPos(e)>(F.value[1]-F.value[0])/2+F.value[0]?1:0}}else r=0;Array.isArray(e.modelValue)&&($.value=r),Array.isArray(e.modelValue)?null===(t=A.value[r])||void 0===t||t.focus():null===(o=f.value)||void 0===o||o.focus(),h.value=!0,a("drag-start")})(l,$.value)},hasMouseDown:C,trackStyles:R,pinsCol:z,checkActivePin:checkActivePin,isFocused:g,isActiveDot:isActiveDot,getTrackLabel:(a,l)=>e.trackLabel?"function"==typeof e.trackLabel?e.trackLabel(a,l):e.trackLabel:a,currentSliderDotIndex:$,ariaLabelIdComputed:J,ariaAttributesComputed:W}}});C.ssrRender=function ssrRender(e,a,l,r,t,o,i,s){const v=n("va-icon");a(`<div${b(u({class:["va-slider",e.sliderClass]},e.ariaAttributesComputed,r))}>`),(e.vertical?e.$slots.append:e.$slots.prepend)?(a('<div class="va-slider__input-wrapper" aria-hidden="true">'),A(e.$slots,e.vertical?"append":"prepend",{},null,a,l),a("</div>")):a("\x3c!----\x3e"),!e.$slots.label&&!e.label||e.invertLabel?a("\x3c!----\x3e"):(a(`<span class="va-input__label"${g("id",e.ariaLabelIdComputed)} style="${h(e.labelStyles)}">`),A(e.$slots,"label",{},(()=>{a(`${x(e.label)}`)}),a,l),a("</span>")),(e.vertical?e.iconAppend:e.iconPrepend)?(a('<span class="va-input__label" aria-hidden="true">'),a(k(v,{name:e.vertical?e.iconAppend:e.iconPrepend,color:e.getColor(e.$props.color),size:16},null,l)),a("</span>")):a("\x3c!----\x3e"),a(`<div class="va-slider__container"><div class="va-slider__track" aria-hidden="true" style="${h(e.trackStyles)}"></div>`),e.pins?(a("\x3c!--[--\x3e"),_(e.pinsCol,((l,r)=>{a(`<div class="${$([{"va-slider__mark--active":e.checkActivePin(l)},"va-slider__mark"])}" style="${h(e.getPinStyles(l))}"></div>`)})),a("\x3c!--]--\x3e")):a("\x3c!----\x3e"),e.$props.range?(a(`\x3c!--[--\x3e<div aria-hidden="true" class="${$([{"va-slider__track--active":e.isFocused},"va-slider__track va-slider__track--selected"])}" style="${h(e.processedStyles)}"></div>\x3c!--[--\x3e`),_(e.orders,(r=>{a(`<div class="${$([e.dotClass,"va-slider__handler"])}" style="${h(e.getDottedStyles(r))}"${g("tabindex",e.disabled||e.readonly?void 0:0)}>`),e.isActiveDot(r)?a(`<div style="${h({backgroundColor:e.getColor(e.$props.color)})}" class="va-slider__handler__dot--focus"></div>`):a("\x3c!----\x3e"),e.trackLabelVisible?(a(`<div style="${h(e.labelStyles)}" class="va-slider__handler__dot--value">`),A(e.$slots,"trackLabel",{value:e.getValueByOrder(r),order:r},(()=>{a(`${x(e.getTrackLabel(e.getValueByOrder(r),r))}`)}),a,l),a("</div>")):a("\x3c!----\x3e"),a("</div>")})),a("\x3c!--]--\x3e\x3c!--]--\x3e")):(a(`\x3c!--[--\x3e<div aria-hidden="true" class="${$([{"va-slider__track--active":e.isFocused},"va-slider__track va-slider__track--selected"])}" style="${h(e.processedStyles)}"></div><div class="${$([e.dotClass,"va-slider__handler"])}" style="${h(e.dottedStyles)}"${g("tabindex",e.$props.disabled||e.$props.readonly?void 0:0)}>`),e.isActiveDot(0)?a(`<div class="va-slider__handler__dot--focus" style="${h({backgroundColor:e.getColor(e.$props.color)})}"></div>`):a("\x3c!----\x3e"),e.trackLabelVisible?(a(`<div class="va-slider__handler__dot--value" style="${h(e.labelStyles)}">`),A(e.$slots,"trackLabel",{value:e.getValueByOrder()},(()=>{a(`${x(e.getTrackLabel(e.getValueByOrder()))}`)}),a,l),a("</div>")):a("\x3c!----\x3e"),a("</div>\x3c!--]--\x3e")),a("</div>"),(e.vertical?e.iconPrepend:e.iconAppend)?(a('<span class="va-input__label--inverse" aria-hidden="true">'),a(k(v,{name:e.vertical?e.iconPrepend:e.iconAppend,color:e.getColor(e.$props.color),size:16},null,l)),a("</span>")):a("\x3c!----\x3e"),(e.$slots.label||e.label)&&e.invertLabel?(a(`<span class="va-input__label va-input__label--inverse" style="${h(e.labelStyles)}">`),A(e.$slots,"label",{},(()=>{a(`${x(e.label)}`)}),a,l),a("</span>")):a("\x3c!----\x3e"),(e.vertical?e.$slots.prepend:e.$slots.append)?(a('<div class="va-slider__input-wrapper">'),A(e.$slots,e.vertical?"prepend":"append",{},null,a,l),a("</div>")):a("\x3c!----\x3e"),a("</div>")},C.__file="src/components/va-slider/VaSlider.vue";const L=e(C);export{L as VaSlider};
//# sourceMappingURL=index48.js.map
