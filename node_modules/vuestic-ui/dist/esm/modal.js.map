{"version":3,"file":"modal.js","sources":["../../src/components/va-modal/modal.ts"],"sourcesContent":["import { VaModal } from './VaModal'\nimport type { ModalOptions } from './types'\nimport { VNode, render, AppContext, h, nextTick } from 'vue'\n\ntype OptionKeys = keyof ModalOptions;\n\nconst getNodeProps = (vNode: VNode): Record<OptionKeys, any> => {\n  return (vNode.component?.props as Record<OptionKeys, any>) || {}\n}\n\nconst destroy = (el: HTMLElement | null | undefined, vNode: VNode | null) => {\n  if (el) {\n    render(null, el)\n    el.remove()\n  }\n\n  el = null\n  vNode = null\n}\n\nconst mount = (\n  component: any,\n  { props, appContext }: { props?: ModalOptions; appContext?: AppContext } = {},\n): { vNode: VNode; el?: HTMLElement } => {\n  const el: HTMLElement | undefined = document?.createElement('div')\n\n  // eslint-disable-next-line prefer-const\n  let vNode: VNode | null\n\n  // handling the case when 'withoutTransitions = false'\n  const onClose = (event: HTMLElement) => {\n    props?.onClose?.(event)\n    destroy(el, vNode)\n  }\n\n  // handling the case when 'withoutTransitions = true'\n  const onUpdateModelValue = (value: boolean) => {\n    props?.['onUpdate:modelValue']?.(value)\n\n    if (props?.withoutTransitions && !value) {\n      nextTick(() => { // this is required for all handlers to execute\n        destroy(el, vNode)\n      })\n    }\n  }\n\n  vNode = h(component, {\n    ...props,\n    stateful: props?.stateful ?? true,\n    modelValue: true,\n    onClose,\n    'onUpdate:modelValue': onUpdateModelValue,\n  })\n\n  if (appContext) {\n    vNode.appContext = appContext\n  }\n\n  if (el) {\n    render(vNode, el)\n  }\n\n  return { vNode, el }\n}\n\nconst getModalOptions = (options: string | ModalOptions): ModalOptions => typeof options === 'string'\n  ? { message: options }\n  : options\n\nexport const createModalInstance = (customProps: ModalOptions | string, appContext?: AppContext): VNode => {\n  const { vNode, el } = mount(VaModal, { appContext, props: getModalOptions(customProps) })\n\n  if (el && vNode.el && getNodeProps(vNode)) {\n    document.body.appendChild(el.childNodes[0])\n  }\n\n  return vNode\n}\n"],"names":[],"mappings":"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"}